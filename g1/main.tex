% !Mode:: "TeX:UTF-8"
\documentclass{article}
\input{en_preamble.tex}
\input{xecjk_preamble.tex}
\setCJKmainfont{STKaiti} % 如果请替换为本地系统有的字体
%中文断行
\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip = 0pt plus 1pt minus 0.1pt
\newcommand{\Span}{\text{span}}
\newcommand{\Null}{\text{Null}}
\newcommand{\Ran}{\text{Ran}}
\begin{document}
\title{第一章$\qquad$线性代数的背景}
%\date{\today}
\maketitle  %定义时间和标题
%\tableofcontents
%\newpage
\section{}
\subsection{矩阵}
在这一章中，~$\mathrm{C}^{n\times m}$ 是定义在$C$上的$n\times m$的矩阵构成的向量空间.

加法：$C=A+B$，~这里的$A$，~$B$和$C$都$\in\mathrm{C}^{n\times m}$，~即$c_{ij}=a_{ij}+b_{ij}$.

数乘：$C=\alpha A$，~即$c_{ij}=\alpha a_{ij}$.

乘法：$C=AB$，~这里A$\in\mathrm{C}^{n\times m}$，~B$\in\mathrm{C}^{m\times p}$，~C$\in\mathrm{C}^{n\times p}$，~即$c_{ij}=\sum_{k=1}^m a_{ik}b_{kj}$.

$a_{*j}$表示矩阵A的第j列，~$a_{i*}$表示矩阵A的第i行.
$A^H$表示矩阵$A$的转置共轭矩阵，~即$A^H=\bar{A}^T=\overline{A^T}$.
\subsection{方阵与特征值}

$I$表示单位矩阵，~若$CA=AC=I$，~则称矩阵$C$为矩阵$A$的逆矩阵$A^{-1}$.
$$det(A)=a_{11}A_{11}-a_{12}A_{12}+\cdots+(-1)^{1+n}a_{1n}A_{1n}=\sum_{j=1}^n (-1)^{j+1} a_{1j}det(A_{1j}) .$$

如果$det(A)=0$，~则称矩阵$A$是奇异的，~否则称$A$为非奇异的.

$$det(AB)=det(A)det(B),$$

$$det(A^T)=det(A),$$

$$det(\alpha A)=\alpha ^n det(A),$$

$$det(\bar{A})=\overline{det(A)},$$

$$det(I)=1.$

\newtheorem{definition}{定义}
\begin{definition}
设$A$是$n$阶方阵，~如果存在数$\lambda$和非零$n$维列向量$u$，~使得$Au=\lambda u$成立，~则称$\lambda$是$A$的一个特征值，~非零向量$u$称为矩阵$A$的对应于特征值$\lambda$的特征向量.

$$p_A(\lambda)=det(A-\lambda I),$$
称为矩阵$A$的特征多项式，~$\lambda $是矩阵$A$的特征值当且仅当
$$det(A-\lambda I)\equiv p_A(\lambda)=0,$$
即$\lambda$是矩阵$A$的特征多项式的一个根.

矩阵$A$的谱是指$A$的所有特征值组成的集合，~记为$\sigma (A)$.

矩阵$A$是奇异的当且仅当$A$有一个特征值为$0$.
\end{definition}

\newtheorem{proposition}{命题}
\begin{proposition}
矩阵$A$是非奇异的当且仅当$A$可逆.

矩阵$A$的谱半径等于矩阵$A$的特征值的模的最大值，~记为$\rho (A)$.~矩阵$A$的迹等于$A$的所有对角线元素的和，~记为$tr(A)=\sum_{i=1}^n a_{ii}$，~也等于$A$的所有特征值的和.
\end{proposition}

\newtheorem{proposition}{命题}
\begin{proposition}
如果$\lambda$是矩阵$A$的特征值，~那么$\bar\lambda$是矩阵$A^H$的特征值.

如果存在一个非零列向量$x$使得$Ax=\lambda x$，~则称$\lambda $为一个右特征值，~$x$称为矩阵$A$的特征值$\lambda $的右特征向量.
如果存在一个非零列向量$y$使得$yA=y\lambda$，~则称$\lambda $为一个左特征值，~$y$称为矩阵$A$的特征值$\lambda $的左特征向量.

$$Au=\lambda u,~v^HA=\lambda v^H,$$

$$u^HA^H=\bar{\lambda}u^H,~ A^Hv=\bar{\lambda}v.$$
\end{proposition}

\subsection{矩阵类型}
接下来介绍一些特殊的矩阵类型：

\begin{tabular}{ |l|l| }   
\hline   
矩阵类型 & 含义\\
\hline
对称矩阵 & $A^T=A$ \\
\hline
Hermitian矩阵 & $A^H=A$ \\
\hline
反对称矩阵 & $A^T=-A$ \\
\hline
反埃尔米特矩阵 &  $A^H=-A$ \\
\hline
正规矩阵 &  $A^HA=AA^H$ \\
\hline
非负矩阵 & $a_{j}\ge 0,\ i,j=1,...,n$(同理定义非正矩阵) \\
\hline
酉矩阵 & $Q^HQ=I$ \\
\hline 
对角矩阵 & $a_{ij}=0,\ i\neq j$,\ 记$A=diag(a_{11},a_{22},...,a_{nn})$ \\
\hline
上三角矩阵 & $a_{ij}=0,\ i>j$,\ 类似，\ 下三角矩阵：$a_{ij}=0,\ i<j$ \\
\hline
上双对角线矩阵 & $a_{ij}=0,\ i\neq j$,\ 或者$j\neq i+1$.类似，下双对角矩阵：$a_{ij}=0,\ i\neq j$,\ 或者$j\neq i-1$ \\
\hline 
三对角线矩阵 & $a_{ij}=0,\ |j-i|>1$,\ 形如$A=tridiag(a_{i,i-1},a_{ii},a_{i,i+1})$ \\
\hline
带矩阵 & $a_{ij}\neq 0,\ i-m_l\leqslant j\leqslant i+m_u$,\ $m_l,m_u$是两个非负整数，\ 数$m_l+m_u+1$叫做矩阵的带宽 \\
\hline
Upper Hessenberg 矩阵 & $a_{ij}=0,\ i>j+1$.\ 类似 Lower Hessenberg矩阵：$a_{ij}=0,i<j-1$ \\
\hline 
外积矩阵 & $A=uv^H$,\ 此处的$uv$为列向量 \\
\hline
置换矩阵 &它在每行和每列中只有一个$1$,\ 而在其他地方则为$0$ \\
\hline
分块对角矩阵 & $A$的分块矩阵只有在主对角线上有非零子块，\ 其余子块都为零矩阵，\ 且非零子块都是方阵 \\
\hline
\end{tabular}


\subsection{向量内积和范数}
在一个向量空间$X$中，~内积是一个$X\times X$到$C$的一个映射，~$x\in ~X,~y\in ~X,~ s(x,y)\in~ C$，~且它满足如下条件：

1.$s(x,y)$是关于$x$是线性的，~$s(\lambda _1 x_1+\lambda _2 x_2)=\lambda _1 s(x_1,y)+\lambda _2 s(x_2,y),~\forall~ x,~y~\in X,~\forall ~\lambda _1 ,~\lambda _2 \in~ C$.

2.$s(x,y)=\overline{s(y,x)},\ \forall ~x,\ y\in~ X$，~当$x,~y$取实数域时$s(x,y)=s(y,x)$.

3.$s(x,y)\ge 0$当且仅当$x=0$时，~等号成立.

4.Cauchy-Schwartz不等式：$\vert s(x,x)\vert^2\leqslant s(x,x)s(y,y)$.

特别注意当X空间取复数域时，~内积$(x,y)=\sum_{i=1}^n x_i\bar{y}_i$，~它经常被写成$(x,y)=y^Hx$.~欧几里德内积在矩阵计算中的一个基本性质：$(Ax,y)=(x,A^Hy),\ \forall ~x,\ y\in~ C$.

\newtheorem{proposition}{命题}
\begin{proposition}
酉矩阵是保持欧几里德内积不变，~$(Qx,Qy)=(x,y)$，~对任意酉矩阵和向量$x,~y$都成立.
\end{proposition}

证明：$(Qx,Qy)=(x,Q^HQ)=(x,y)$.

在内积空间中，~我们可以定义范数，~令$\parallel x\parallel=\sqrt{(x,x)}$，~则此由内积定义的范数满足：

1.$\parallel x\parallel \ge 0,\ \forall ~x\in~X$，\ 并且$\parallel x\parallel=0$当且仅当$x=0$.

2.$\parallel \alpha x\parallel =|\alpha| \parallel x\parallel,\ \forall ~x\ \in ~ X,\ \forall ~\alpha \ \in~ C$.

3.$\parallel x+y \parallel \leqslant \parallel x\parallel + \parallel y\parallel ,~\forall ~x,~y\in~ X$.

从上面的命题可以看出，~一个酉矩阵作用向量后是保范的，~$\parallel Qx \parallel_2=\parallel x \parallel_2.$由此我们可以看出酉矩阵是保范的.\ 下面介绍向量的几个范数：
$\parallel x \parallel_p=(\sum_{i=1}^n |x_i|^p)^{1/p}$，\ 且当$p=1,2,\infty$时

$$\parallel x \parallel_1=|x_1|+|x_2|+...+|x_n|,$$

$$\parallel x \parallel_2=[|x_1|^2+|x_2|^2+..+|x_n|^2]^{1/2},$$

$$\parallel x \parallel_\infty=\max |x_i|,$$

Cauchy-Schwartz不等式变成$|(x,y)|\leqslant \parallel x \parallel_2\parallel y\parallel_2$.

\subsection{矩阵范数}

设矩阵$A\in\mathrm{C}^{n\times m}$，~定义矩阵$A$的范数
$$\parallel A\parallel _{pq}=\max\frac{\parallel Ax\parallel _p}{\parallel x\parallel _q},$$
这里$x\neq 0$，~$x\in\mathrm{C}^{m}$.

范数满足下面的性质：

$$\parallel A\parallel\ge 0,\ \forall ~A~\ \in\mathrm{C}^{n\times m},$$并且$\parallel A\parallel = 0$当且仅当$A=0$.

$$\parallel\alpha A\parallel = |\alpha|\parallel A\parallel,\ \forall ~A\ \in\mathrm{C}^{n\times m},\ \forall~\alpha\ \in\mathrm{C},$$

$$\parallel A+B\parallel\leqslant\parallel A\parallel+\parallel B\parallel,\ \forall~ A,B\ \in\mathrm{C}^{n\times m}.$$

当$q=p$时的范数称为$p-$范数，~有
$$\parallel AB\parallel _p\leqslant\parallel A\parallel _p\parallel B\parallel_p.$$

对于方阵$A$，有$\parallel A^k\parallel_p\leqslant\parallel A\parallel ^k _p$，~如果$A^k$的$p-$范数小于$1$，~那么$A^k$收敛到$0$.

矩阵$A$的Frobenius范数定义为$(\sum_{j=1}^m\sum_{i=1}^n |a_{ij}|^2)^{1/2}$.

$$\parallel A\parallel_1 = max\sum_{i=1}^n |a_{ij}|,\ j=1,2,\cdots,m.$$

$$\parallel A\parallel_\infty= max\sum_{j=1}^m |a_{ij}|,\ i=1,2,\cdots,n.$$

$$\parallel A\parallel_2=[\rho(A^HA)]^{1/2}=[\rho(AA^H)]^{1/2},$$

$$\parallel A\parallel_F=[tr(A^HA)]^{1/2}=[tr(AA^H)]^{1/2}.$$

设A$\in\mathrm{C}^{n\times m}$，~$A^HA$的特征值是非负的，~$A^HA$的$m$个非负特征值的算术平方根叫作$A$的奇异值.~$\parallel A\parallel_2$等于矩阵$A$的最大的奇异值，~记为$\sigma_1$.

\subsection{子空间，秩和核}
向量集$G=\lbrace a_1,a_2,\cdots,a_q\rbrace$的所有线性组合是一个向量子空间，~叫做$G$的线性扩张.

%\span\null\ran

$$ \Span \lbrace G \rbrace=\Span\lbrace a_1,a_2,\cdots,a_q\rbrace=\lbrace z\in\mathrm{C}^n|z=\sum_{i=1}^q{\alpha _i a_i},\ \lbrace\alpha _i\rbrace_{i=1,2,\cdots q}\ \in\mathrm{C}^q\rbrace,$$
如果$a_1,a_2,\cdots,a_q$是线性无关的，~那么$a_1,a_2,\cdots,a_q$叫做$ \span{G}$的一组基.

给定两个向量子空间$S_1$和$S_2$，~它们的和$S=S_1+S_2$也是一个向量子空间，~定义为$S_1$中的所有向量和$S_2$中的所有向量的和.~两个向量子空间的交集还是一个子空间，~如果交集为${0}$，~则称$S_1$与$S_2$的和为直和，~记为$S=S_1\bigoplus S_2$.~当S等于$C^n$时，~$\forall x\ \in C^n$，~存在唯一的向量$x_1\in S_1$和$x_2\in S_2$，~使得$x=x_1+x_2$，~且分解是唯一的.

矩阵$A$有两个重要的子空间，~一是象空间，~记为$ \Ran(A)=\lbrace Ax|x\in\mathrm{C}^m\rbrace$；~二是核（零空间），~记为$ \Null(A)=\lbrace x\in\mathrm{C}^m|Ax=0\rbrace$.
 
矩阵$A\in\mathrm{C}^{n\times m}$的秩等于线性无关的列数，~也等于线性无关的行数；~当$A$的秩等于$m$和$n$的最小值时，~就说$A$是满秩的.

$$\mathrm{C}^n=\Ran(A)\bigoplus \Null(A^T),\ \mathrm{C}^m=\Ran(A^T)\bigoplus \Null(A).$$

当$AS\subset S$时，~就说子空间$S$在方阵$A$下是不变的，~比如$ \Null(A-\lambda I)$在矩阵$A$下是不变的，~$ \Null(A-\lambda I)$子空间称为与$\lambda$相关的特征子空间，~由矩阵$A$的特征值$\lambda$的所有特征向量再加上零向量构成.


\subsection{正交向量和子空间}
一个向量集合$G=\lbrace a_1,a_2,...a_r\rbrace$如果满足$(a_i,a_j)=0,~i\neq j$，~则称为正交集.~且对$G$的每一个向量$\parallel a_i \parallel_2=1$，~称为标准正交集.~一个向量正交于子空间$S$的每一个向量，~就称正交于这个子空间.~与$S$所有正交的向量的构成的集合是一个子空间，~称为$S$的正交补，~记$S^\perp$.~且任何向量都可以分解成$S$与$S^\perp$中的向量和.

每一个子空间都有一个标准正交基，~这个标准正交基是通过任意一组基标准正交化得到的，~通常用Gram-Schmidt算法求出.

\begin{definition}
设$A\in ~C^{n\times n}$，~如果存在$n$阶酉矩阵$Q$和$n$阶上三角矩阵$R$，~使$A=QR$则称之为$A$的$QR$分解或酉三角分解.~当$A\in~ R^{n\times n}$时，\ 称为$A$的正三角分解.
\end{definition}

任意满秩实（复）矩阵$A$，~都可以唯一地分解$A=QR$，~其中$Q$为正交（酉）矩阵，~$R$是具有正对角元的上三角矩阵.
\subsection{矩阵的规范形式}
下面讨论将方阵简化对角线形式，~ 或者上三角形式的简单方阵，~且这种简单转化保留特征值不变.

\begin{definition}
矩阵$A,B$称为相似的，~如果存在一个非奇异矩阵$X$使得$A=X^{-1}BX.$  
\end{definition}

对进行的运算关系称为相似变换，~ 称可逆矩阵为相似变换矩阵.

下面介绍一些定义：

1.矩阵$A$的一个特征值是几重根，~ 这个几重根就叫做这个特征值的代数重数.

2.如果一个特征值的代数重数是$1$，~ 则这个特征值是单的(simple)；~ 矩阵$A$的特征值代数重数不是$1$,~ 则是非单的(nonsimple).

3.矩阵$A$的特征值所对应的特征向量所构成空间(即特征子空间)的维数，~称为几何重数.

4.当代数重数等于几何重数时的特征值称为半单的(semisimple)，~ 当特征值不是半单的时被称为defective.

5.当一个矩阵至少有一个特征值的几何重数大于$1$时，~ 这个矩阵称为derogatory.
\subsubsection{矩阵可对角化}
\newtheorem{thm}{定理}
\begin{thm}
$n$维矩阵可对角化，~ 当且仅当它有$n$个线性无关的特征向量.
\end{thm}

\newtheorem{thm}{定理}
\begin{thm}
$n$维矩阵可对角化，~当且仅当它的所有特征值是半单的(几何重数等于代数重数).
\end{thm}

\subsubsection{若尔当标准型}
\begin{definition}
若尔当标准型是由若干个主对角线为特征值，~下方（或上方）次对角线全为1，~其余全为0的若尔当块按对角排列组成的准对角矩阵.~不是每个$n$阶矩阵通过初等变换都能化为对角矩阵，~但每个$n$阶复数矩阵$A$通过初等变换都能化为若尔当标准型，~这个若尔当形矩阵除去其中若尔当块的排列次序不同外是被矩阵$A$唯一确定的，~它称为矩阵$A$的若尔当标准型.
\end{definition}

\newtheorem{thm}{定理}
\begin{thm}
如何一个矩阵$A$都可以简化为由$p$个对角块组成的对角矩阵，~每个对角块与一个不同特征值$\lambda _i$有关.~每个对角块本身是由$\gamma _i$个子块构成的对角结构，~其中$\gamma _i$是特征值$\lambda _i$的几何重数.~个子块是若尔当块，~由这些若尔当块组成的准对角矩阵称为若尔当标准型.

一个矩阵$A$存在一个可逆矩阵$X$，~使得
$$X^{-1}AX=J=\begin{bmatrix}
J_1 &\cdots & 0\\
0 &J_2\cdots & 0\\
\vdots & \ddots & \vdots\\
0 & \cdots & J_p
\end{bmatrix},$$

$$\begin{bmatrix}
J_{i1} &\cdots & 0\\
0 &J_{i2}\cdots & 0\\
\vdots & \ddots & \vdots\\
0 & \cdots & J_{i\gamma _i}
\end{bmatrix},$$其中
$$\begin{bmatrix}
\lambda _i &1&\cdots & 0&0\\
0 &\lambda _i&1&\cdots & 0\\
0&0&\vdots & \ddots & \vdots\\
0&0&\vdots & \ddots &1\\
0 &0&0& \cdots &\lambda _i
\end{bmatrix},$$

每一个$J_{ik}$块与特征值$\lambda _i$有关.
\end{thm}
\subsubsection{Schur分解}
下面将得出任何一个方阵都可以唯一相似一个上三角矩阵.

\newtheorem{thm}{定理}
\begin{thm}
对任意方阵$A$，~存在一个酉矩阵$Q$，~使得$Q^HAQ=R$，~其中$R$是一个上三角矩阵.
\end{thm}

这个其实就是Schur分解，~当$AQ=QR$时，~推出对任意$i\leqslant j\leqslant k$，~我们有$Aq_j=\sum_{i=1}^{i=j} r_{ij}q_i$.~如果将矩阵$Q,R$按列分块，~令$Q_k=[q_1,q_2,...,q_k]$，~并且$R_k$也是$R$的前$k$列，~我们同样有$AQ_k=Q_kR_k$，~这被称为矩阵$A$的部分Schur分解.~并且最简单的形式当$k=1$时，~这里的$q_1$是一个特征向量，~平时$q_i$被称为舒尔向量.
\subsubsection{矩阵幂的应用}
\newtheorem{thm}{定理}
\begin{thm}
序列$A^k,\ k=0,1,...,$收敛于$0$时当且仅当$\rho (A)<1$.
\end{thm}
证明：必要性

当序列$A^k,k=0,1,...,$收敛于0时，~我们假设$u_1$是模最大的特征值$\lambda _1$对应的单位特征向量，~于是有
$$A^ku_1=\lambda _1^ku_1,$$
两边同时取二范数可得，
$$\vert \lambda _1^k\vert=\parallel A^ku_1\parallel_2\longrightarrow 0,$$
因此可得$\rho (A)=\vert \lambda _1^k\vert<1.$

充分性

假设$\rho (A)<1$，~首先对于矩阵$A^k$，~存在可逆矩阵$X$，~使得
$$A^k=XJ^kX^{-1}.$$
为证$A^k$收敛于$0$，~即证$J^k$收敛于$0$，~因此我们只需要证明每一个若尔当块收敛于$0$即可，~每一个若尔当块有如下形式
$$J_i=\lambda _iI+E_i,$$
其中$E_i$是一个指数为$l_i$的幂零矩阵，~即$E_i^{l_i}=0$.因此当$k\geqslantl_i$，
$$J_i^k=\sum_{j=0}^{l_i-1}\frac{k!}{j!(k-j)!}\lambda _i^{k-j}E_i^j,$$
当$k\geqslant l_i$时，~两边取任何范数，~由三角不等式可得
$$\parallel J_i^k\parallel \leqslant \sum_{j=0}^{l_i-1}\frac{k!}{j!(k-j)!}\lambda _i^{k-j}\parallel E_i^j\parallel ,$$
因为$\vert \lambda _i^k\vert<1$，~所以当$k\longrightarrow 0$时，~左端趋于$0$,~因此$A^k$也收敛于$0$.


\newtheorem{thm}{定理}
\begin{thm}
级数$\sum_{k=0}^\infty A^k$ 收敛当且仅当$\rho (A)<1$.~在这个条件下，~$I-A$是非奇异的并且这个级数的极限等于$(I-A)^{-1}$.
\end{thm}
证明：必要性

由上一个定理可知是显然的.

充分性

当$\rho (A)<1$时，~为了证明这个结论是正确的，~使用下面等式：
$$I-A^{k+1}=(I-A)(I+A+A^2+...+A^k),$$
因为$\rho (A)<1$，~则$I-A$是可逆的，~因此有
$$(I-A)^{-1}(I-A{k+1})=I+A+A^2+...+A^k,$$
因此当$k\longrightarrow 0$时左手边趋于$(I-A)^{-1}$，~所以结论成立.




\newtheorem{thm}{定理}
\begin{thm}
对于任意矩阵范数$\parallel .\parallel$，~我们有$\lim_{k \to \infty}\parallel A^k\parallel ^{1/k}=\rho (A).$
\end{thm}

\subsection{正规矩阵和埃尔米特矩阵}
\subsubsection{正规矩阵}
一个矩阵$A$，~如果满足$A^HA=AA^H$，~就说它是正规矩阵.
\newtheorem{lemma}{引理}
\begin{lemma}
如果一个正规矩阵是三角形矩阵，~那么它是对角线矩阵.
\end{lemma}

\newtheorem{thm}{定理}
\begin{thm}
一个矩阵是正规矩阵当且仅当它相似于一个对角线矩阵.
\end{thm}

\newtheorem{lemma}{引理}
\begin{lemma}
一个矩阵是正规矩阵当且仅当它的特征向量也是$A^H$的特征向量.
\end{lemma}

\newtheorem{corollary}{推论}
\begin{corollary}
当正规矩阵A的全部特征值为实数时，~称A为埃尔米特矩阵.
\end{corollary}
任何矩阵的特征值$\lambda$满足关系$\lambda =\frac{(Au,u)}{(u,u)}$，~这里u是$\lambda$的特征向量.

$\forall x \ \in\mathrm{C}^n$，~且$x\neq 0$，~定义它的瑞利商为$\mu (x)=\frac{(Ax,x)}{(x,x)}$.\ 当x取遍$\mathrm{C}^n$时所构成的集合，~称为矩阵A的值域.\ 并且对于任意的 $x \in\mathrm{C}^n$，~有$|\mu (x)|\leqslant \parallel A\parallel _2$，~即在矩阵A的2范数下，~$A$的值域是有界的.

如果一个矩阵是正规矩阵，~那么$\mathrm{C}^n$中的每一个向量x都可以为$\sum_{i=1}^n \xi _i q_i$，~这里的$q_i$属于特征向量的正交基向量组，~所以$\mu (x)$可以表示为$\mu (x)=\frac{(Ax,x)}{(x,x)}=\frac{\sum_{k=1}^n \lambda _k|\xi _k|^2}{|\xi _k|^2}=\sum_{k=1}^n \beta _k\lambda _k$，~这里$0\leqslant \beta _i=\frac{|\xi _i|^2}{\sum_{k=1}^n |\xi _k|^2}\leqslant 1$，~$\sum_{i=1}^n \beta _i=1$.

\subsubsection{埃尔米特矩阵}
\newtheorem{thm}{定理}
\begin{thm}
埃尔米特矩阵的特征值都是实数.
\end{thm}
证明:
设$\lambda$是矩阵$A$的特征值，~$u$是相应的单位特征向量，~那么
$$\lambda=\frac{(Au,u)}{(u,u)}=(Au,u)=(u,A^{H}u)=(u,Au)=\overline{(Au,u)}=\overline{\lambda}.$$


\newtheorem{thm}{定理}
\begin{thm}
每一个埃尔米特矩阵相似于一个实对角线矩阵.
\end{thm}

把埃尔米特矩阵$A$的的特征值按照从大到小的顺序排序，~得到$\lambda _1\ge \lambda _2\ge \cdots\ge\lambda _n.$\ 这里的特征值不一定是不同的，~可以重复出现，~下面引出Courant—Fisher 最小最大值原理.
\newtheorem{thm}{定理}
\begin{thm}
$S$是$C^n$的一个子空间，$$\lambda _k=\min \limits_{S,\ dim(S)=n-k+1} \max \limits_{x\in S,\ x\neq 0}\frac{(Ax,x)}{(x,x)}.$$
\end{thm}
证明:
令$\lbrace q_i\rbrace _{i=1,\ldots,n}$是$C^n$的一组标准正交基，~并且是由$A$的特征值$\lambda _1,\cdots,\lambda _n$相应的特征向量构成的.\ 令$S_k$表示前$k$个特征向量扩张成的子空间，~$\mu (S)$表示子空间$S$上的最大的$(Ax,x)/(x,x)$.~那么$S_k$与$n-k+1$维的子空间$S$的交不为$\lbrace 0\rbrace$，~因此存在向量$x\in S\cap S_k$.~设$x=\sum_{i=1}^k\xi_iq_i$，~因为$Aq_i=\lambda _iq_i$，~那么有
$$\frac{(Ax,x)}{(x,x)}=\frac{(A\sum_{i=1}^k\xi_iq_i,\sum_{i=1}^k\xi_iq_i)}{(\sum_{i=1}^k\xi_iq_i,\sum_{i=1}^k\xi_iq_i)}=\frac{\sum_{i=1}^k\lambda _i\mid\xi _i\mid ^2}{\sum_{i=1}^k\mid\xi _i\mid ^2}\ge\lambda _k,$$
所以$\mu (S)\ge\lambda _k$.

另一方面，~令$S_0$表示由$q_k,\cdots,q_n$扩张的$(n-k+1)$维子空间，~那么$\forall x\in S_0$，~有
$$\frac{(Ax,x)}{(x,x)}=\frac{(A\sum_{i=k}^n\xi_iq_i,\sum_{i=k}^n\xi_iq_i)}{(\sum_{i=k}^n\xi_iq_i,\sum_{i=k}^n\xi_iq_i)}=\frac{\sum_{i=k}^n\lambda _i\mid\xi _i\mid ^2}{\sum_{i=k}^n\mid\xi _i\mid ^2}\le\lambda _k,$$
所以$\mu (S_0)\le\lambda _k$.

矩阵$A$的最大特征值是
$$\lambda _1=\max \limits_{x\neq 0}\frac{(Ax,x)}{(x,x)}.$$

$\lambda _k$也可以写成$$\lambda _k=\max \limits_{S,\ dim(S)=n-k+1} \min \limits_{x\in S,\ x\neq 0}\frac{(Ax,x)}{(x,x)}.$$

矩阵$A$的最小特征值是$$\lambda _n=\min \limits_{x\neq 0}\frac{(Ax,x)}{(x,x)}.$$

如果埃尔米特矩阵$A$的特征值都是正数，\ 即$$(Ax,x)>0,\ \forall x\in C^n,\ x\neq 0,$$
那么称矩阵$A$为正定矩阵.

若特征值都是非负的，~即$$(Ax,x)\ge 0,\ \forall x\in C^n,\ x\neq 0.$$则称$A$为半正定矩阵.

$A^HA$一定是半正定矩阵，~`因为$$(A^HAx,x)=(Ax,Ax)\ge 0,\ \forall x.$$
同理有$AA^H$.
%\newtheorem{thm}{定理}
%\begin{thm}
%埃尔米特矩阵的特征值$\lambda _i$和特征向量$q_i$，有$\lambda _1=\frac{(Aq_1,q_1)}{(q_1,q_1)}=\max \limits_{x\in \mathrm{C}^n,x\neq 0}\frac{(Ax,x)}{(x,x)}$，当$k>1$时，有$\lambda _k=\frac{(Aq_k,q_k)}{(q_k,q_k)}=\max \limits_{x\neq 0,q_1^Hx=\cdots q_{k-1}^Hx=0}\frac{(Ax,x)}{(x,x)}$
%\end{thm}

\subsection{非负矩阵和$M$矩阵}
\newtheorem{definition}{定理}
\begin{definition}
$A$和$B$是两个$n\times m$矩阵，~$O$表示$n\times m$的零矩阵，~如果当$1\le i\le n$，~$1\le j\le m$时，~有$a_{ij}\le b_{ij}$，~那么就说$A\le B$.~如果$A\ge O$，~就说$A$是非负矩阵；~如果$A>O$，~就说$A$是正矩阵.~如果$A\le O$，~就说$A$是非正矩阵；~如果$A<O$，~就说$A$是负矩阵.
\end{definition}

\newtheorem{proposition}{命题}
\begin{proposition}

1. $\le$满足自反性，~即$A\le A$；~满足反对称性，~即如果$A\le B$，~$B\le A$，~那么$A=B$；~满足传递性，~即如果$A\le B$，~$B\le C$，~那么$A\le C$.

2. 如果$A$和$B$是非负矩阵，~那么$AB$和$A+B$也是非负矩阵.

3. 如果$A$是非负矩阵，~那么$A^K$也是非负矩阵.

4. 如果$A\le B$，~那么$A^T\le B^T$.

5. 如果$O\le A\le B$，~那么$\parallel A\parallel _1\le\parallel B\parallel _1$，~$\parallel A\parallel _{\infty}\le\parallel B\parallel _{\infty}$.
\end{proposition}

如果存在置换矩阵$P$使得$PAP^T$是上三块矩阵，~就说矩阵$A$是可约的，~否则就说是不可约的.

\newtheorem{thm}{定理}
\begin{thm}
令$A$是一个$n\times n$的非负不可约矩阵，~那么矩阵$A$的谱半径$\rho (A)\equiv\lambda$是一个单特征值，~并且存在相应的正的特征向量.
\end{thm}

\newtheorem{proposition}{命题}
\begin{proposition}
$A$，~$B$，~$C$是三个非负矩阵，~并且$A\le B$，~那么$AC\le BC$，~$CA\le CB$.
\end{proposition}

\newtheorem{corollary}{推论}
\begin{corollary}
$A$，~$B$是两个非负矩阵，~并且$A\le B$，~那么$A^k\le B^k$，~$\forall ~k\ge 0$.
\end{corollary}

\newtheorem{thm}{定理}
\begin{thm}
$A$，~$B$是两个方阵，~并且$O\le A\le B$，~那么$\rho (A)\le\rho (B)$.
\end{thm}
证明:

定理:对于任意矩阵范数$\parallel .\parallel$，~我们有$\lim_{k \to \infty}\parallel A^k\parallel ^{1/k}=\rho (A).$

由上面的的定理可知，~对于任何的矩阵范数，~有$$\rho (X)=\lim_{k \to \infty}\parallel X^k\parallel ^{1/k},$$这里选择1—范数，~那么有$$\rho (A)=\lim_{k \to \infty}\parallel A^k\parallel ^{1/k}_1\le\lim_{k \to \infty}\parallel B^k\parallel ^{1/k}_1=\rho (B).$$


\newtheorem{thm}{定理}
\begin{thm}
$B$是一个非负矩阵，~那么$\rho (B)<1$当且仅当$I-B$是非奇异矩阵，~并且$(I-B)^{-1}$是非负矩阵.
\end{thm}
证明:
定义矩阵$C=I-B$，~若$\rho (B)<1$，~则$C=I-B$是非奇异的，~并且$$C^{-1}=(I-B)^{-1}=\sum_{k=0}^\infty B^i.$$由$B$的非负性，~可知$(I-B)^{-1}$是非负矩阵.

\newtheorem{definition}{定理}
\begin{definition}
矩阵$A$如果满足下面4条性质，~就说它是一个$M$矩阵：

1. $a_{i,i}>0$，~$i=1, \ldots ,n$，

2. $a_{i,j}\le 0$，~$i\neq j$，~$i,j=1,\ldots ,n$，

3. $A$是一个非奇异矩阵，

4. $A^{-1}\ge 0$.
\end{definition}

令$A$是满足性质1，2的矩阵，~令$D$是对角矩阵，~且对角线上的元素与$A$相同，~那么$D>0$，~$$A=D-(D-A)=D(I-(I-D^{-1}A)).$$现在定义$B=I-D^{-1}A$，
由前一个定理可知，~$\rho (B)<1$当且仅当$I-B=D^{-1}A$是非奇异矩阵，~并且$(I-B)^{-1}=A^{-1}D\ge 0$.~由此引出下面的定理.

\newtheorem{thm}{定理}
\begin{thm}
矩阵$A$如果满足下面两条性质：

1. $a_{i,i}>0$，~$i=1,\ldots ,n$，

2. $a_{i,j}\le 0$，~$i\neq j$，~$i,j=1,\ldots ,n$，

那么$A$是$M$矩阵当且仅当$\rho (B)<1$，~这里$B=I-D^{-1}A$.
\end{thm}

\newtheorem{thm}{定理}
\begin{thm}
矩阵$A$满足下面$3$条性质：

1. $a_{i,j}\le 0$，~$i\neq j$，~$i,j=1,\ldots ,n$，

2. $A$是一个非奇异矩阵，

3. $A^{-1}\ge 0$，

那么

4. $a_{i,i}>0$，~$i=1,\ldots ,n$，~即$A$是一个$M$矩阵，

5. $\rho (B)<1$，~这里$B=I-D^{-1}A$.
\end{thm}

\newtheorem{thm}{定理}
\begin{thm}
矩阵$A$和$B$满足下面两条性质：

1. $A\le B$，

2. $b_{ij}\le 0$，~$\forall ~i\neq j$.

如果$A$是$M$矩阵，~那么$B$也是$M$矩阵.
\end{thm}
证明:
假设$A$是一个$M$矩阵，~令$D_X$表示一个对角线矩阵，~并且对角线上的元素与矩阵$X$的相同，~那么有
$$D_B\ge D_A>O.$$
引入矩阵$I-D_B^{-1}B$，~因为$A\le B$，~那么
$$D_A-A\ge D_B-B\ge O,$$
$$I-D^{-1}_AA=D^{-1}_A(D_A-A)\ge D^{-1}_A(D_B-B)\ge D^{-1}_B(D_B-B)=I-D^{-1}_BB\ge O.$$
因为矩阵$I-D^{-1}_BB$和矩阵$I-D^{-1}_AA$是非负矩阵，~由定理12和定理14可得
$$\rho (I-D^{-1}_BB)\le\rho (I-D^{-1}_AA)<1,$$
因此$B$是一个$M$矩阵.

\subsection{正定矩阵}
如果一个实矩阵满足$(Au,u)>0$，~$\forall~u\in  R^n$，~$u\neq 0$，~那么称它是正定的.
正定矩阵$A$满足$A^T=A$，~则称它是正定对称矩阵.
正定矩阵$A$满足$A^H=A$，~则称它是埃尔米特正定矩阵.

任一个方阵$A$（实的或者复的）都可以分解成
$$A=H+iS,$$
其中
$$H=\frac{1}{2}(A+A^H),$$
$$S=\frac{1}{2i}(A-A^H).$$

则矩阵$H$，~$S$都是埃尔米特矩阵，~而$iS$是斜埃尔米特矩阵.~上式说明任何一个方阵都可以写成一个埃尔米特矩阵和一个斜埃尔米特矩阵的和.~这个分解类似与一个复数$z$可以分解成$z=x+iy$，
$$x=\Re (z)=\frac{1}{2}(z+\bar{z}),~y=\Im (z)=\frac{1}{2i}(z-\bar{z}).$$

%当方阵$A$是实的，$u$是实向量时，$(Au,u)$是实的，结果上述的分解$A=H+iS$可以写成$(Au,u)=(Hu,u)$，由此可以得到下面定理

\begin{thm}
令方阵$A$是实的正定矩阵，~则$A$是非奇异的.~此外，~存在一个标量$\alpha >0$使得
$$(Au,u)\geqslant \alpha \parallel u \parallel _2^2,~\forall ~u~\in R^n.$$
\end{thm}
证明:
如果$A$是奇异的，~那么存在一个非零向量$u$，~使得$Au=0$，~与$(Au,u)=0$与正定矩阵的定义相反，~因此$A$是非奇异的.~下面证明定理的第二部分内容.
因为$A$是实正定矩阵，~所以$(Au,u)=(Hu,u)$，~再由最小—最大原理可得，
$$\min \limits_{u\neq 0}\frac{(Au,u)}{(u,u)}=\min \limits_{u\neq 0}\frac{(Hu,u)}{(u,u)}\geqslant \lambda_{min}(H)>0.$$
取$\alpha \equiv  \lambda_{min}(H)$，~就得到上述不等式.


\begin{thm}
当$A$是任意方阵（可能为复方阵），~令$H=\frac{1}{2}(A+A^H),S=\frac{1}{2i}(A-A^H)$.~则矩阵$A$的任意特征向量$\lambda _i$有
$$\lambda_{min}(H)\leqslant \Re (\lambda _j)\leqslant \lambda_{max}(H),$$
$$\lambda_{min}(S)\leqslant \Im (\lambda _j)\leqslant \lambda_{max}(S).$$
\end{thm}
证明:
假设$\parallel u_j\parallel=1$，~则有
$$\lambda_{j}=(Au_j,u_j)=(Hu_j,u_j)+i(Su_j,u_j),$$
$$\Re (\lambda _j)=(Hu_j,u_j),$$
$$\Im (\lambda _j)=(Su_j,u_j).$$


\subsection{投影算子}
如果一个有界算子是幂等的，~即满足$P^2=P$，~则是投影算子.

\subsubsection{投影的值域和零空间}
投影有一些简单性质，如果$P$是一个投影，则$I-P$也是一个投影，~并且有以下关系：
$$\Null(P)=\Ran(I-P).$$
此外，
$$\Null(P)\bigcap \Ran(P)=\lbrace 0\rbrace,$$
因为若存在向量$x\in \Null(P)\bigcap \Ran(P)$，~则$Px=0$，~且存在一个向量$x_1$，~使得$Px_1=x$，而$x=Px_1=P^2x_1=P(Px_1)=Px=0$，~所以$x=0$.

此外，~因为$C^n$中每一个元素都可以被写成$x=Px+(I-P)x$，~$Px\in~\Ran(P),~(I-P)x\in~\Null(P)$因此空间$C^n$可以被分解成
$$C^n=\Null(P)\bigoplus \Ran(P).$$

相反，如果有两个子空间$M$，~和$S$，~使得
$$C^n=M\bigoplus S,$$
则可以定义一个唯一的投影$P$，~使得
$$\Ran(P)=M,~\Null(P)=S,$$
投影算子$P$可以被它的两个子空间（\Ran(P)和\Null(P)）唯一确定.
即对于任何向量$x\in C^n$，~$x$，~$Px$满足下面两个条件：
$$Px\in M,$$
$$x-Px\in S.$$


定义$L=S^\bot$，~令$u=Px$，~那么
$$u\in M,$$
$$x-u\bot L.$$

\newtheorem{thm}{定理}
\begin{thm}
给定$C^n$空间的两个相同维数的子空间$M$和$L$，~下面的两个条件是相互等价的.

(1).子空间$M$中没有非零向量正交于$L$;

(2).对于$\forall x\in C^n$，~存在唯一的$u$，~使得$u\in M,x-u\in L^\bot.$
\end{thm}
证明：

由（1）可知$M$中任一向量如果垂直$L$都是零向量，~它等价于
$$M\cap L^\perp={0}.$$
又因为$\dim L=m,\dim L^\perp=n-m$，~可知
$$\dim M+\dim L^\perp=n,$$
则
$$C^n=M\bigoplus L^\perp.$$
这就等价于对于$C^n$中任一向量$z$都可以唯一的分解成
$$z=x+y,~x\in M,~y=z-x \in L^\perp,$$
所以可以由结论一得到结论二.结论二到结论一显然是成立的.

由上面讨论可知，~给两个子空间$M$和$L$，~如果满足$M\cap L^\perp={0}$，~将存在一个$L$到$M$上的算子$P$，~满足$u=Px,u\in M,x-u\in L$.~并且这个算子使得
$$\Ran(P)=M,\Null(P)=L^\perp.$$
特殊情况下，~如果$Px=0$，~则值的是$x\in \Null(P)$，~即$x \in L^\perp$.~结论二到结论一显然是成立的.~于是我们得到一个有用的性质，
$$Px=0~~iff~~x\perp L. $$


\subsubsection{正交投影算子和Oblique投影}
\begin{definition}
当$\Null(P)=\Ran(P)^\bot$时，~投影$P$称为$M$上的正交投影，~不是正交投影的投影称为Oblique投影.
因此正交投影$P$可以通过下面的式子定义：
任取向量$x$，~有
$$Px\in M,$$
$$(I-P)x\bot M.$$
等价于
$$Px\in M,\ ((I-P)x,y)=0,\ \forall y\in M,$$
\end{definition}
现在定义$P$的伴随算子：对于任意$x$和$y$有
$$(Px,y)=(x,P^Hy),$$
$P^H$也是一个投影算子，~因为$$((P^H)^2x,y)=(P^Hx,Py)=(x,P^2y)=(x,Py)=(P^Hx,y),$$
由$x$，~$y$是的任意性，~所以有$(P^H)^2=P^H$，~即$P$的伴随算子$P^H$也是一个投影算子.

\subsubsection{正交投影的性质}
$P$是$X$到$M$上的一个正交投影算子，~则$x$的分解$x=Px+(I-P)x$中的向量$Px,\ (I-P)x$是正交的，~且满足
$$\parallel x\parallel _2^2=\parallel Px\parallel _2^2+\parallel (I-P)x\parallel _2^2,$$
因此
$$\parallel Px\parallel _2\le \parallel x\parallel_2,$$
因为$\parallel P\parallel _2=max\frac{\parallel Px\parallel _2}{\parallel x\parallel _2}$，~所以$\parallel P\parallel _2\le 1.$
又因为可以取到$M$上的一个向量$x$且$\parallel x\parallel _2=1$，~因为$\parallel Px\parallel _2=\parallel x\parallel _2=1$，~则$\parallel P\parallel _2=1$.

\begin{thm}
$P$是投影到$M$上的正交投影算子，~则$C^n$上的任意向量$x$，~和$M$中任意向量$y$都满足
$$\min \limits_{y\in M}\parallel x-y\parallel _2=\parallel x-Px\parallel _2.$$
\end{thm}
证明:
假设$y$是$M$中任意向量，~考虑它到$x$的距离平方.~因为$x-Px$正交于$M$，~$Px-y\in M$，~则$x-Px$正交于$Px-y$，
$$\parallel x-y\parallel _2^2=\parallel x-Px+(Px-y)\parallel _2^2=\parallel x-Px\parallel _2^2+\parallel Px-y\parallel _2^2,$$
所以$M$中的任意向量$y$都满足$\parallel x-y\parallel _2\le \parallel x-Px\parallel _2$，~并且当$y=Px$时取得最小值.

\newtheorem{corollary}{推论}
\begin{corollary}
任给定子空间$M$，~对$C^n$中任意向量$x$，~则$\min \limits_{y\epsilon M} \parallel x-y\parallel _2= \parallel x-y^*\parallel _2$，~当且仅当它满足
$$\begin{cases}
y^*  \epsilon M, \\
x-y^*\perp M.
\end{cases}
$$
\end{corollary}

\subsection{基本概念}
\subsubsection{解的存在性}
$Ax=b$是一个线性方程组.

情况1：矩阵$A$是非奇异的，~那么只有一个解$x=A^{-1}b$.

情况2：矩阵$A$是奇异的，~并且$\Ran(A)=\Ran(A,b)$，~那么存在一个解$x_0$，~使得$Ax_0=b$，~又$\forall v \in \Null(A)$，~$x_0+v$也是$Ax=b$的解，~因此方程组有无穷多个解.

情况3：矩阵$A$是奇异的，~并且$\Ran(A)\neq \Ran(A,b)$，~那么方程组无解.

\subsubsection{扰动分析}
$A$是一个$n\times n$的非奇异矩阵，~思考前面的线性方程组$Ax=b$，~任给矩阵$E$，~使得当$\varepsilon$足够小时，~矩阵$A(\varepsilon)=A+\varepsilon E$是非奇异的.假设我们对上述线性方程组中的数据进行了扰动，~即用$\varepsilon E$扰动$A$，~用$\varepsilon e$扰动$b$.\ 扰动线性方程组的解满足下面的方程
$$(A+\varepsilon E)x(\varepsilon)=b+\varepsilon e.$$

令$\delta (\varepsilon)=x(\varepsilon)-x$，~那么
$$(A+\varepsilon E)\delta (\varepsilon)=(b+\varepsilon e)-(A+\varepsilon E)x=\varepsilon (e-Ex),$$
$$\delta (\varepsilon)=\varepsilon (A+\varepsilon E)^{-1}(e-Ex).$$
函数$x(\varepsilon)$在$\varepsilon =0$处是可微的，~它的微分定义为$$x^\prime (0)=\lim_{\varepsilon \to\ 0}\frac{\delta (\varepsilon)}{\varepsilon}.$$
当数据发生变化时，~即$[A,b]$在方向$[E,e]$上受到扰动，$x(\varepsilon)$的导数的大小表示解$x(\varepsilon)$变化的大小，
$$\frac{\parallel x(\varepsilon)-x\parallel}{\parallel x\parallel}\le\varepsilon\parallel A^{-1}\parallel(\frac{\parallel e\parallel}{\parallel x\parallel}+\parallel E\parallel)+o(\varepsilon).$$
因为$\parallel b\parallel\le\parallel A\parallel\parallel x\parallel$，~那么
$$\frac{\parallel x(\varepsilon)-x\parallel}{\parallel x\parallel}\le\varepsilon\parallel A\parallel\parallel A^{-1}\parallel(\frac{\parallel e\parallel}{\parallel b\parallel}+\frac{\parallel E\parallel}{\parallel A\parallel})+o(\varepsilon).$$











%\title{第二章$\qquad$偏微分方程离散化}
%\date{\today}
%\maketitle  %定义时间和标题
%\tableofcontents
%\newpage
\section{}
\subsection{偏微分方程}

 凡含有参数，~未知函数和未知函数导数 (或微分) 的方程，~称为微分方程，~有时简称为方程，~未知函数是一元函数的微分方程称作常微分方程，~未知数是多元函数的微分方程称作偏微分方程.

稀疏矩阵：在矩阵中，~若数值为$0$的元素数目远远多于非$0$元素的数目，~并且非$0$元素分布没有规律时，~则称该矩阵为稀疏矩阵；~与之相反，~若非$0$元素数目占大多数时，~则称该矩阵为稠密矩阵.

求解偏微分方程的典型方法是离散化.~把离散化后的方程写成矩阵形式，~那么得到的矩阵通常是稀疏矩阵.~有三种不同的方法可以离散偏微分方程，~分别是有限差分法、有限元法、有限体积法.~下面主要介绍有限差分法：

有限差分法：先对求解区域作网格剖分，~将自变量的连续变化区域用有限离散点（网格点）集代替；~将问题中出现的连续变量的函数用定义在网格点上离散变量的函数代替；~通过用网格点上函数的差商代替导数，~将含连续变量的偏微分方程定解问题化成只含有限个未知数的代数方程组（称为差分格式）.~如果差分格式有解，~且当网格无限变小时其解收敛于原微分方程定解问题的解，~则差分格式的解就作为原问题的近似解（数值解）.

\subsubsection{椭圆算子}
%Poisson方程:泊松方程是数学中一个常见于静电学、机械工程和理论物理的偏微分方程.是因法国数学家、几何学家及物理学家泊松而得名的.  
%泊松方程是非齐次的拉普拉斯方程，
梯度：表示某一函数$u(x)$在该点处的方向导数沿着该方向取得最大值，~即函数在该点处沿着该方向（此梯度的方向）变化最快，~变化率最大,
$$\triangledown u=\begin{pmatrix}
 \frac{\partial u}{\partial x_1} \\
\frac{\partial u}{\partial x_2}
\end{pmatrix}.$$

散度：描述向量场$\vec{v}$在场中某点附近发散或汇聚的程度，
$$div\vec{v}=\triangledown \cdot \vec{v}=\dfrac{\partial v_1}{\partial x_1}+\dfrac{\partial v_2}{\partial x_2}.$$

拉普拉斯算子：
$$\triangle=\dfrac{\partial ^2}{\partial x_1^2}+\dfrac{\partial ^2}{\partial x_2^2}.$$

椭圆算子：
$$L=\dfrac{\partial}{\partial x_1}(a\dfrac{\partial}{\partial x_1})+\dfrac{\partial}{\partial x_2}(a\dfrac{\partial}{\partial x_2})=\triangledown \cdot (a\triangledown).$$
由此椭圆算子可以写成：
$$L=\dfrac{\partial}{\partial x_1}(a_1\dfrac{\partial}{\partial x_1})+\dfrac{\partial}{\partial x_2}(a_2\dfrac{\partial}{\partial x_2})=\triangledown (\vec a\cdot \triangledown).$$

拉普拉斯方程:~可以从许多具有物理意义的数学模型中得到，~通常让$u$表示在平衡态下某一物理量在区域$\Omega$内的密度分布（如温度、浓度、静电位势等）.~令$V$为$\Omega$内的任何光滑区域，~$\overrightarrow{F}$表示$u$的流速.~由于$u$处于平衡态，~那么通过$V$的边界流入和流出$V$的总流量相等，~于是我们有
$$\int_{\partial V} \overrightarrow{F}\cdot\overrightarrow{n} \, \mathrm{d}S =0.$$
其中$\overrightarrow{n}$为$\partial\Omega $的单位外法向量，利用高斯—格林公式得到
$$\int_{V} div\overrightarrow{F}\, \mathrm{d}x =\int_{\partial V} \overrightarrow{F}\cdot\overrightarrow{n} \, \mathrm{d}S =0.$$
由于区域$V$当任意性，~我们有
$$div\overrightarrow{F}=0.$$
在许多物理问题中，~假设流速$\overrightarrow{F}$$u$的梯度$Du$成正比.~又因为流量总是从高浓度处流向低浓度处，~因此$\overrightarrow{F}$与梯度$Du$的方向相反，~于是
$$\overrightarrow{F}=-aDu.$$
其中$a>0$是正数，~把等式代入上述方程，~我们得到拉普拉斯方程$div(Du)=\triangle u=0$.

poisson方程：
$$\dfrac{\partial ^2u}{\partial x_1^2}+\dfrac{\partial ^2u}{\partial x_2^2}=f,$$
$$\forall x=\begin{pmatrix}
x_1  \\
x_2
\end{pmatrix} \epsilon  \Omega.$$

$\Omega$是$R^n$上的一个有界的开集，~$x_1,x_2$是两空间变量.~上述方程只适用于位于域$\Omega$内部的点，~同样重要的是在$\Omega$的边界$\mathcal{T}$上必须满足的条件.~这些被称为边界条件，~它们有三种常见类型:

Dirichlet条件：           $u(x)=\phi (x)$,

Neumann条件：             $\frac{\partial u}{\partial \vec{n}}(x)=0$,

Cauchy条件：$\frac{\partial u}{\partial \vec{n}}(x)+\alpha(x)u(x)=\gamma (x)$.

 $\vec n$ 是 $\Omega$ 边界 $\mathcal{T}$ 上的单位外法线向量.~对于给定的单位向量$\vec{v}$有两分量$v_1,v_2$，~方向导数$\frac{\partial u}{\partial \vec{v}}$定义为：
 
 $$\frac{\partial u}{\partial \vec{v}}(x)=\lim_{h \to\ 0}\frac{u(x+h\vec{v})-u(x)}{h},$$

 $$=\frac{\partial u}{\partial x_1}(x)v_1+\frac{\partial u}{\partial x_2}(x)v_2,$$

 $$=\triangledown u.\vec{v},$$

 $\triangledown$为$u$的梯度：
 $$\triangledown u=\begin{pmatrix}
 \frac{\partial u}{\partial x_1} \\
\frac{\partial u}{\partial x_2}
\end{pmatrix}.$$

特殊情况是当$f(x)=0$时，~$\triangle u=0$，并且边界条件必须加上，~这就是拉普拉斯方程.



\subsubsection{对流扩散方程}
许多问题涉及“对流”和“扩散”的结合.用对流扩散方程模拟了下面的现象：

$$\dfrac{\partial u}{\partial t}+b_1\dfrac{\partial u}{\partial x_1}+b_2\dfrac{\partial u}{\partial x_2}=\triangledown .(a\triangledown)u+f$$
或者
$$\dfrac{\partial u}{\partial t}+\vec b.\triangledown u=\triangledown .(a\triangledown)u+f$$

这个稳定状态的版本还可以写成：$$-\triangledown .(a\triangledown)u+\vec b.\triangledown u=f$$

\subsection{有限差分法}
有限差分法基于偏微分方程的偏导数的局部近似，由低阶泰勒级数展开导出的.
\subsubsection{基本近似}
通过公式$(\frac{du}{dx})(x)\thickapprox \frac{u(x+h)-u(x)}{h}$近似函数$u$在点$x$的一阶导数，这个公式又称为向前差分，只有一阶精度.当$u$是可微的，$h$趋于$0$时，上式差分的极限是$u$在点$x$处的导数.
如果$u\in \mathrm{C}^4$，利用泰勒展示可得$u(x+h)=u(x)+h\frac{du}{dx}+\frac{h^2}{2}\frac{d^2u}{dx^2}+\frac{h^3}{6}\frac{d^3u}{dx^3}+\frac{h^4}{24}\frac{d^4u}{dx^4}(\xi _+)$,$\xi _+ \in (x,x+h)$.因此，向前差分近似满足下面公式：
$$\frac{du}{dx}=\frac{u(x+h)-u(x)}{h}-\frac{h}{2}\frac{d^2u(x)}{dx^2}+O(h^2)$$

用$-h$代替$h$后，得到
$$u(x-h)=u(x)-h\frac{du}{dx}+\frac{h^2}{2}\frac{d^2u}{dx^2}-\frac{h^3}{6}\frac{d^3u}{dx^3}+\frac{h^4}{24}\frac{d^4u}{dx^4}(\xi _-)$$.

其中$\xi _- \in (x-h,x)$.

把这两项相加，利用中值定理得到下面的$2$阶导数近似：
$$\frac{d^2u(x)}{dx^2}=\frac{u(x+h)-u(x)+u(x-h)}{h^2}-\frac{d^4u(\xi)}{dx^4}$$.

这里$\xi _-\le\xi\le\xi_+$，这个公式称为中心差分近似.

$(\frac{du}{dx})(x)\thickapprox \frac{u(x)-u(x-h)}{h}$称为向后差分，把向前、向后公式取平均后得到中心差分公式：
$$\frac{du(x)}{dx}\approx\frac{u(x+h)-u(x-h)}{2h}$$

记向前、向后差分算子的表达式：
$$\delta ^+ u(x)=u(x+h)-u(x)$$

$$\delta ^- u(x)=u(x)-u(x-h)$$

%$$\frac{d}{dx}\langle a(x)\frac{d}{dx}\rangle=\frac{1}{h^2}\delta ^+(a_{i-1/2}\delta ^- u)+O(h^2)\approx\frac{a_{i+1/2}(u_{i+1}-u_i)-a_{i-1/2}(u_{i}-u_{i-1})}{h^2}$$
%这个公式具有$2$阶精度。

\subsubsection{拉普拉斯算子的差分方法}
使用$x_1$变量的网格大小$h_1$和$x_2$变量的网格大小$h_2$，得到以下二阶精度近似结果：
$$\vartriangle u(x)\approx\frac{u(x_1+h_1,x_2)-2u(x_1,x_2)+u(x-h_1,x_2)}{h^2 _1}+\frac{u(x_1,x_2+h_2)-2u(x_1,x_2)+u(x_1,x_2-h_2)}{h^2 _2}$$
当$h_1=h_2$时，上面的公式变为:
$$\vartriangle u(x)\approx\frac{1}{h^2}[u(x_1+h,x_2)+u(x_1-h,x_2)+u(x_1,x_2+h)+u(x_1,x_2-h)-4u(x_1,x_2)]$$
这个公式又称为5点中心近似，具有二阶精度，它的误差为$\frac{h^2}{12}(\frac{\partial^4 u}{\partial^4 x_1}+\frac{\partial^4 u}{\partial^4 x_2})+O(h^2)$.

\subsubsection{一维问题的有限差分}
思考下面的一维问题：

$$-u^{\prime\prime}(x)=f(x),x\in(0,1)$$
$$u(0)=u(1)=0$$
离散区间$[0,1]$，得到$n+2$个点$x_i=i\timesh,i=0,\ldots ,n+1$，这里$h=1/(n+1)$，因为这是狄利克雷边值问题，所以$u(x_0)$和$u(x_{n+1})$已知，在其它点上，用$u_i$近似精确解$u(x_i)$.

在$x_i$处用中心差分近似得到下面的公式：

$$-u_{i-1}+2u_i-u_{i+1}=h^2f_{i}$$
$u_i$，$u_{i-1}$，$u_{i+1}$是未知的，$f_i\equiv f(x_i)$。当$n=6$时，得到下面的线性方程组：
$$Ax=f$$
这里$$A=\frac{1}{h^2}\begin{bmatrix}
2 & {-1}\\
-1 & 2 & {-1}\\
 & {-1} & 2 & {-1}\\
 &  & {-1} & 2 & {-1}\\
 &  &  & {-1} & 2 & {-1}\\
 &  &  &  & {-1} & 2 
\end{bmatrix}$$

%\subsubsection{迎风格式}
%考虑一维对流扩散方程的稳定状态的特殊情况，当系数$a,b$为常数时，且$f=0$时，使用狄利克雷边界条件，
%$$\begin{cases}
%-au^"+bu^'=0, & 0<x<L=1 \\
%u(0)=0,&u(L)=1.
%\end{cases}$$
%在这种特殊情况下，我们可以解上述方程
%$$u(x)=\frac{1-e^{Rx}}{1-e^R}$$
%这里的$R=bL/a$.现在通过中心差分的格式给出一阶和二阶导数的近似，则未知方程变为
%$$b\dfrac{u_{i+1}-u_{i-1}}{2h}-a\dfrac{u_{i+1}-2u_i+u_{i-1}}{h^2}=0,$$
%我们定义$c=\frac{Rh}{2}$,
%$$-(1-c)u_{i+1}+2u_i-(c+1)u_{i-1}=0$$
%这是一个二阶齐次线性差分方程，我们找一个$u_j=r^j$形式的解，则$r$必须满足
%$$(1-c)r^2-2r+(c+1)=0$$
%因此$r_1=1,r_2=\frac{1+c}{1-c}$是根，上面差分方程的解是这两个根的线性组合
%$$u_i=\alpha r_2^i+\beta r_2^i=\alpha +\beta(\frac{1+c}{1-c})^i$$
%因为边界条件$u_0=0$,得$\beta=-\alpha$,同理由边界条件$u_{n+1}=1$得
%$$\alpha=\frac{1}{1-\sigma ^{n+1}},\sigma \equiv \frac{1+c}{1-c}$$
%因此解是
%$$u_i=\frac{1-\sigma ^i}{1-\sigma ^{n+1}}$$

%我们取$n=6$时，

%$$A=\frac{1}{h^2}\begin{bmatrix}
%2 & {-1+c}\\
%-1_c & 2 & {-1+c}\\
 
 %& {-1_c} & 2 & {-1+c}\\
 %&  & {-1-c} & 2 & {-1+c}\\
 %&  &  & {-1-c} & 2 & {-1+c}\\
 %&  &  &  & {-1-c} & 2
 %\end{bmatrix}$$
 %上面的矩阵不是对角占优矩阵.
 %如果一阶导数使用向后差分：
 %$$b\frac{u_i-u_{i-1}}{h}-a\frac{u_{i-1}-2u_i+u_{i+1}}{h^2}=0.$$
 %定义$c=Rh$得
 %$$(-1+c)u_{i+1}+(2+c)u_i-(1+c)u_{i-1}$$

 %$$A=\frac{1}{h^2}\begin{bmatrix}
%2+c & {-1}\\
%-1 & {2+c} & {-1}\\
 %& {-1-c} & {2+c} & {-1}\\
 %&  & {-1-c} & {2+c} & {-1}\\
 %&  &  & {-1-c} & {2+c} & {-1}\\
 %&  &  &  & {-1-c} & {2+c} 
 %\end{bmatrix}$$
%如果一阶导数使用向前差分：

%$$b\frac{u_{i+1}-u_i}{h}-a\frac{u_{i-1}-2u_i+u{i+1}}{h^2}=0.$$

%定义$c=Rh$得
%$$-u_{i-1}+(2-c)u_i+(c+1)u_{i+1}$$
%$$A=\frac{1}{h^2}\begin{bmatrix}
%2-c & {c-1}\\
%-1 & {2-c} & {c-1}\\
% & {-1} & {2-c} & {c-1}\\
 %&  & {-1} & {2-c} & {c-1}\\
 %&  &  & {-1} & {2-c} & {c-1}\\
 %&  &  &  & {-1} & {2-c} 
 %\end{bmatrix}$$




%\subsubsection{二维问题的有限差分}
%类似之前的例子，考虑下面的问题，
%$$-(\dfrac{\partial ^2u}{\partial x_1^2}+\dfrac{\partial ^2u}{\partial x_2^2})=f,in ~~\Omega $$
%$$u=0, on ~~\Gamma$$
%现在我们取定义域$\Omega$为$(0,1)\times (0,1)$，$\Gamma$是它的边界，现在我们将两边进行离散，如下图，
%\begin{figure}[H]
%\centering
%\includegraphics[scale=0.7]{./figures/1.png}
%\caption{}
%\end{figure}
%两边取点$n_1=n_2=4$时，$h_1=h_2=\frac{1}{n+1}$利用五点中心近似
%$$\vartriangle u(x)\approx\frac{1}{h^2}[u(x_1+h,x_2)+u(x_1-h,x_2)+u(x_1,x_2+h)+u(x_1,x_2-h)-4u(x_1,x_2)]$$
%得
%$$A=\frac{1}{h^2}\begin{bmatrix}
%B & {-I}\\
%-I & B & {-I}\\
 %& {-I} & B
%\end{bmatrix}$$
%其中
%$$B=\begin{bmatrix}
%4 & {-1}\\
%-1 & 4 & {-1}\\
%  & {-1} & 4 & {-1}\\
%  & & {-1} & 4
% \end{bmatrix}$$

\subsection{有限元法}
考虑Dirichlet边界条件的Poisson方程：
\begin{eqnarray}
-\Delta u(x) &=& f(x),\text{ on } \Omega.\label{eq:P}\\
u|_{\partial\Omega} &=& 0.
\end{eqnarray}

{\large Galerkin方法}

有限元方法是一种基于 PDE (partial differential equations) 的变分形式 (variational formulation) 求解PDE近似解的方法.

引入函数空间 $H^1(\Omega)$, 对于任意 $v \in H^1(\Omega)$, $v$和它的一阶导数都在 $\Omega$ 上 $L^2$ 可积. 这里的 $H^1(\Omega)$ 是一个无限维的空间.

另外, 引入空间 $H^1_0(\Omega) := \{v\in H^1(\Omega), v|_{\partial\Omega} = 0\}$.

对于任意的 $v\in H^1_0(\Omega)$, 同乘以方程 \eqref{eq:P} 的两端, 然后做分部积分可得: 

\begin{equation}\label{eq:wg}
\int_{\Omega}\nabla u\cdot\nabla v\mathrm{d}x = \int_{\Omega}fv\mathrm{d}x,\quad\forall~ v \in H^1_0(\Omega).
\end{equation}

原问题（从微分方程转变成了积分方程）就转化为: 求解 $u\in H_0^1(\Omega)$, 满足

\begin{equation}\label{eq:W}
a(u,v) = <f,v>,\forall~ v\in H_0^1(\Omega).
\end{equation}

其中

$$
a(u,v) = \int_{\Omega}\nabla u\cdot\nabla v\mathrm{d}x,\quad <f,v> =  \int_{\Omega}fv\mathrm{d}x.
$$

%泛函也是一种“函数”，泛函的定义域是一个函数集，值域是实数集或实数集的子集，简言之，泛函就是函数的函数。

下面我们考虑所谓 Galerkin 方法来求 \eqref{eq:W} 的逼近解. 上面 $H_0^1(\Omega)$ 是一个无限维的空间,
为了把无限维的问题转化为有限维的问题, 引入 $H_0^1(\Omega)$ 的一个有限维的子空间 $V$, 比如
$V=\mathrm{span}\{\phi_1,\phi_2,\ldots,\phi_N\}$. 对任何 $v \in V$, 它都有唯一的表示

$$
v = \sum\limits_{i=1}^N v_i\phi_i.
$$

可以看出空间 $V$ 和 $N$ 维向量空间 $\mathbb{R}^N$ 是同构的, 即

$$
v = \sum\limits_{i=1}^N v_i\phi_i\leftrightarrow\mathbf{v} =
\begin{pmatrix}
v_1 \\ v_2 \\ \vdots \\ v_N
\end{pmatrix}
$$

其中列向量 $\mathbf{v}$ 是 $v$ 在基 $\{\phi_i\}_{i=1}^N$ 的坐标.
下面可以构造一个离散的问题: 求 $ \tilde u = \sum_{i=1}^{N}u_i \phi_i \in V$, 其对应的向量为 $\mathbf u$, 满足

\begin{equation}\label{eq:d}
a(\tilde u, v) = <f, v>,\quad\forall~v\in V.
\end{equation}

方程 \eqref{eq:d} 中仍然包含有无穷多个方程. 但 $V$ 是一个有限维空间, 本质上 $\tilde u= \sum_{i=1}^{N}u_i \phi_i$ 只需要满足下面 $N$ 方程即可

$$
\begin{cases}
a(\tilde u, \phi_1) = <f, \phi_1> \\
a(\tilde u, \phi_2) = <f, \phi_2> \\
\vdots \\
a(\tilde u, \phi_N) = <f, \phi_N> 
\end{cases}
$$

即

$$
\begin{cases}
a(\sum_{i=1}^{N}u_i \phi_i, \phi_1) = <f, \phi_1> \\
a(\sum_{i=1}^{N}u_i \phi_i, \phi_2) = <f, \phi_2> \\
\vdots \\
a(\sum_{i=1}^{N}u_i \phi_i, \phi_N) = <f, \phi_N> 
\end{cases}
$$
上面的方程可以改写为下面的形式:

$$
\begin{pmatrix}
a(\phi_1, \phi_1) & a(\phi_2, \phi_1) & \cdots & a(\phi_N, \phi_1) \\
a(\phi_1, \phi_2) & a(\phi_2, \phi_2) & \cdots & a(\phi_N, \phi_2) \\
\vdots & \vdots & \ddots & \vdots \\
a(\phi_1, \phi_N) & a(\phi_2, \phi_N) & \cdots & a(\phi_N, \phi_N) \\
\end{pmatrix}
\begin{pmatrix}
u_1 \\ u_2 \\ \vdots \\ u_N
\end{pmatrix}
= 
\begin{pmatrix}
<f, \phi_1> \\ <f, \phi_2> \\ \vdots \\ <f, \phi_N> 
\end{pmatrix}
$$

引入{\large 刚度矩阵}(stiff matrix),
$$
\mathbf{A}=(a_{ij})_{N\times N}  
$$
其中 $a_{ij}=a(\phi_i,\phi_j)$.

和{\large 载荷矢量}(load vector),
$$
\mathbf{f} = \begin{pmatrix}
f_1\\ f_2 \\ \ldots \\f_N
\end{pmatrix} 
$$ 

其中 $ f_i=<f,\phi_i>$. 

可得到如下 $N$ 阶线性方程组:

$$
\mathbf{Au} = \mathbf{f}.
$$

求解可得原问题的逼近解:

$$
\tilde u = \sum\limits_{i=1}^N u_i\phi_i.
$$

{\large 有限元方法 （构造基函数）}


\begin{tabular}{ |l|l| }   
\hline
符号&意义\\
\hline
$\Omega$ & 求解区域\\
\hline
$\mathcal{T}$ & $\Omega$ 上的三角形网格 \\
\hline
$N$ & $\mathcal{T}$ 的节点个数 \\
\hline
$NT$ & $\mathcal{T}$ 的单元个数  \\
\hline
$\mathbf x_i\in\mathbb{R}^2,i=1,\ldots,N$  &  网格节点 \\
\hline
$\tau := (\mathbf x_i,\mathbf x_j,\mathbf x_k)$ & $\mathcal T$ 中由顶点 $(\mathbf x_i,\mathbf x_j,\mathbf x_k)$ 构成三角形单元, 其中顶点按逆时针排序 \\
\hline
$e_{ij} := \overrightarrow{\mathbf x_i\mathbf x_j}$ & $\mathcal T$ 中以 $\mathbf x_i$ 和 $\mathbf x_j$ 为端点的一条边 \\
\hline 
$\tau_{ij}$ & 表示边 $e_{ij}$ 从 $\mathbf x_i$ 看向 $\mathbf x_j$ 左手边的单元 \\
\hline
$(l_i, l_j, l_k)$ & 顶点 $(\mathbf x_i,\mathbf x_j,\mathbf x_k)$ 对应的三边边长 \\
\hline
$W=\begin{pmatrix}0&-1\\1 & 0 \end{pmatrix}$ & 旋转矩阵, 作用在二维列向量上表示逆时针旋转该向量$90^\circ$  \\
\hline 
$I=\begin{pmatrix} 1 & 0\\ 0& 1 \end{pmatrix}$  & 单位矩阵 \\
\hline
$|\tau_m|$ &  $\tau_m$ 的面积 \\
\hline
 $\omega_i$  & $\mathcal T$ 中所有以 $\mathbf x_i$ 为顶点的三角形单元集合 \\
\hline 
%$\xi_{ij}$ & 边 $e_{ij}$ 相邻三角形单元的集合, 如果有两个相邻三角形单元 $\tau_{ij}$ 和 $\tau_{ji}$, 则为**内部边**, 只有一个相邻单元 $\tau_{ij}$, 则为**边界边** \\
%\hline
\end{tabular}

{\large 重心坐标}

给定三角形单元 $\tau$, 其三个顶点 $\mathbf{x}_i :=(x_i,y_i)$, $\mathbf{x}_j :=(x_j,y_j)$ 和 $\mathbf{x}_k :=(x_k,y_k)$ 逆时针排列, 且不在同一条直线上, 那么向量 $\overrightarrow{\mathbf{x}_i\mathbf{x}_j}$ 和 $\overrightarrow{\mathbf{x}_i\mathbf{x}_k}$ 是线性无关的,这等价于矩阵

$$
A = 
\begin{pmatrix}
x_i & x_j & x_k \\
y_i & y_j & y_k \\
1   & 1   & 1 
\end{pmatrix}
$$

是非奇异. 

矩阵A的行列式等于三角形单元$\tau$的2倍（用叉积或海伦公式可得）.

任给一点 $\mathbf{x}:=(x,y)\in\tau$, 求解下面的线性方程组

$$
A 
\begin{pmatrix}
\lambda_i \\
\lambda_j\\
\lambda_k  
\end{pmatrix}
=\begin{pmatrix}
x \\
y\\
1  
\end{pmatrix}
$$

可得唯一的一组解$\lambda_i,\lambda_j,\lambda_k$. 

因此对任意二维点 $\mathbf{x}\in\tau$, 有

$$
\mathbf{x}=\lambda_i(\mathbf{x})\mathbf{x}_i + \lambda_j(\mathbf{x})\mathbf{x}_j + \lambda_k(\mathbf{x})\mathbf{x}_k 
\text{ with } \lambda_i(\mathbf{x}) + \lambda_j(\mathbf{x}) + \lambda_k(\mathbf{x}) = 1. 
$$

$\lambda_1,\lambda_2,\lambda_3$ 称为点 $\mathbf{x}$ 关于点 $\mathbf{x}_1,\mathbf{x}_2$ 和$\mathbf{x}_3$ 的重心坐标. 

重心坐标有它相应的几何意义. 给定 $\mathbf x\in\tau$, 把 $\tau$ 的第 $i$ 个顶点 $\mathbf{x}_i$ 换 $\mathbf{x}$
得到的三角形记为 $\tau_i(\mathbf{x})$, 则由克莱姆法则可得

\begin{equation}\label{eq:bc}
\lambda_i = {|\tau_i(\mathbf{x})| \over |\tau|},
\end{equation}

其中 $|\cdot|$ 表示三角形的面积.

易知, $\lambda_1, \lambda_2, \lambda_3$ 都是关于 $\mathbf x$ 的线性函数, 且有

\begin{eqnarray*}
\lambda_1(\mathbf x_1) = 1,& \lambda_1(\mathbf x_2) = 0,& \lambda_1(\mathbf x_3) = 0\\
\lambda_2(\mathbf x_1) = 0,& \lambda_2(\mathbf x_2) = 1,& \lambda_2(\mathbf x_3) = 0\\
\lambda_3(\mathbf x_1) = 0,& \lambda_3(\mathbf x_2) = 0,& \lambda_3(\mathbf x_3) = 1\\
\end{eqnarray*}

$\lambda_1, \lambda_2, \lambda_3$ 关于 $\mathbf x$ 的梯度为:

$$
\begin{aligned}
\nabla\lambda_i = \frac{1}{2|\tau|}W\vec{\mathbf x_j\mathbf x_k}\\
\nabla\lambda_j = \frac{1}{2|\tau|}W\vec{\mathbf x_k\mathbf x_i}\\
\nabla\lambda_k = \frac{1}{2|\tau|}W\vec{\mathbf x_i\mathbf x_j}\\
\end{aligned}
$$

{\large 线性有限元基函数与空间}

给定求解区域 $\Omega$ 上的一个三角形网格 $\mathcal T$, 它有 $N$ 个网格节点 $\{\mathbf x_i\}_{i=1}^N$, $NT$ 个三角形单元 $\{\tau_m\}_{m=1}^{NT}$.


给定网格节点 $\mathbf x_i$, 记 $\omega_i$ 为 $\mathcal T$ 中所有以 $\mathbf x_i$ 为顶点的三角形单元集合, 即

$$
\omega_i = \{\tau,\,\mathbf x_i \text{ is one vertex of }\tau \in \mathcal T\}
$$

对每个网格节点 $\mathbf x_i$, 可以定义函数 
$$
\phi_i(\mathbf x) =
\begin{cases}
\lambda_i(\mathbf x),& \mathbf x \in \tau_m \in \omega_i\\
0, & \mathbf x \in \tau_m \notin \omega_i
\end{cases}
$$

支集：在集合$X$上的实值函数$f$的支集，$supp(f)=\lbrace x|f(x)\neq 0,x\in X\rbrace$.

由 $\phi_i(\mathbf x)$ 的定义和重心坐标函数的性质可知:

1. $\phi_i(\mathbf x_i)=1$,

2. $\phi_i(\mathbf x)$ 限制在 $\omega_i$ 中的每个单元 $\tau$ 上, 为 $\mathbf x_i$ 对应的重心坐标函数,

3. $\phi_i(\mathbf x)$ 在 $\omega_i$ 以外的单元上函数值为 0,

4. $\text{supp}(\phi_i)=\omega_i$.

因此, 我们可以说 $\phi_i$ 定义在 $\mathcal T$ 上的分片线性连续函数.

把 $\mathcal T$ 中的每个节点函数一起可以做为一组基, 张成一个分片线性连续函数空间,
$$
V = \text{span}\{\phi_1, \phi_2, \cdots, \phi_N\},
$$

{\large 刚度矩阵与右端载荷的计算}

刚度矩阵 $A$ 的每一项
$$
a_{ij} = a(\phi_i, \phi_j) = \int_{\Omega}\nabla \phi_i\cdot\nabla \phi_j\mathrm d\mathbf x
$$

由 $\phi_i$ 的定义可知, 我们并不需要在整个 $\Omega$ 或者说整个 $\mathcal T$ 上来计算上面的积分, 只需要在 $\phi_i$ 和 $\phi_j$ 的支集的交集上计算, 即

$$
\begin{aligned}
&\int_{\Omega}\nabla \phi_i\cdot\nabla \phi_j\mathrm d\mathbf x\\
= &\int_{\omega_i\cap\omega_j}\nabla \phi_i\cdot\nabla \phi_j\mathrm d\mathbf x\\
= & 
\begin{cases}
\sum_{\tau\in\omega_i}\int_{\tau}\nabla \phi_i\cdot\nabla \phi_j\mathrm d\mathbf x, & i=j \\
\int_{\tau_{ij}}\nabla \phi_i\cdot\nabla \phi_j\mathrm d\mathbf x + \int_{\tau_{ji}}\nabla \phi_i\cdot\nabla \phi_j\mathrm d\mathbf x, & e_{ij}\text{ 为内部边} \\
\int_{\tau_{ij}}\nabla \phi_i\cdot\nabla \phi_j\mathrm d\mathbf x, & e_{ij}\text{ 为边界边} \\
0, & \mathbf x_i \text{ 与 } \mathbf x_j\text{ 不相邻}
\end{cases}\\
= & 
\begin{cases}
\sum_{\tau\in\omega_i}\int_{\tau}\nabla \lambda_i\cdot\nabla \lambda_j\mathrm d\mathbf x, & i=j \\
\int_{\tau_{ij}}\nabla \lambda_i\cdot\nabla \lambda_j\mathrm d\mathbf x + \int_{\tau_{ji}}\nabla \lambda_i\cdot\nabla \lambda_j\mathrm d\mathbf x, & e_{ij}\text{ 为内部边} \\
\int_{\tau_{ij}}\nabla \lambda_i\cdot\nabla \lambda_j\mathrm d\mathbf x, & e_{ij}\text{ 为边界边} \\
0, & \mathbf x_i \text{ 与 } \mathbf x_j\text{ 不相邻}
\end{cases}\\
\end{aligned}
$$

由以上推导可知, 我们实际上只需要在每个单元 $\tau$ 上计算出下面六个积分, 即可组装出刚度矩阵:
$$
\begin{aligned}
\int_{\tau}\nabla\lambda_i\cdot\nabla\lambda_i\,\mathrm d \mathbf x\\
\int_{\tau}\nabla\lambda_j\cdot\nabla\lambda_j\,\mathrm d \mathbf x\\
\int_{\tau}\nabla\lambda_k\cdot\nabla\lambda_k\,\mathrm d \mathbf x\\
\int_{\tau}\nabla\lambda_i\cdot\nabla\lambda_j\,\mathrm d \mathbf x\\
\int_{\tau}\nabla\lambda_i\cdot\nabla\lambda_k\,\mathrm d \mathbf x\\
\int_{\tau}\nabla\lambda_k\cdot\nabla\lambda_j\,\mathrm d \mathbf x\\
\end{aligned}
$$
上面的积分是可以直接算出来.

类似上面分解的思想, 右端载荷向量中每一个分量, 可做如下分解:
$$
\begin{aligned}
<f,\phi_i> &= \int_{\Omega}f\phi_i\,\mathrm d\mathrm x\\
& = \int_{\omega_i}f\phi_i\,\mathrm d\mathbf x \\
& = \sum_{\tau\in\omega_i}\int_{\tau}f\phi_i\,\mathrm d\mathbf x\\
& = \sum_{\tau\in\omega_i}\int_{\tau}f\lambda_i\,\mathrm d\mathbf x
\end{aligned}
$$
这意味着, 我们只要在每个三角形单元 $\tau$ 上计算下面三个积分即可, 组装出载荷向量
$$
\begin{aligned}
\int_{\tau}f\lambda_i\,\mathrm d\mathbf x\\
\int_{\tau}f\lambda_j\,\mathrm d\mathbf x\\
\int_{\tau}f\lambda_k\,\mathrm d\mathbf x\\
\end{aligned}
$$




























%\newtheorem{thm}{定理}
%\begin{thm}

%\end{thm}



































%函数$y(x)$的变分定义为$\delta y=y_1(x)-y(x)$，其中$y_1(x)$是“靠近”$y(x)$的一个函数，即$\delta y$是同一自变量$x$处相邻函数的函数值之差。

%注意：

%$(\delta y)'=y'_1(x)-y'(x)=\delta y'$

%$(\delta y)^n=\delta y^n $
%\subsection{泛函的变分}
%定义泛函$J[y(x)]=\int_{a}^{b} f(x,y,y')\mathrm{d}x$，则增量$\bigtriangleup J=\int_{a}^{b}[f(x,y+\delta y,y'+\delta y')-f(x,y,y')]\mathrm{d}x=\int_{a}^{b}[\frac{\partial f}{\partial y}\delta y + \frac{\partial f}{\partial y'}\delta y'+\frac{1}{2}\frac{\partial^2 f}{\partial^2 y}(\delta y)^2+\frac{\partial^2 f}{\partial y\,\partial y'}\delta y\delta y'+\frac{1}{2}\frac{\partial^2 f}{\partial y'^2}(\partial y')^2+\cdots]\mathrm{d}x$

%舍弃掉$\delta y$和$\delta y'$二次项及以上的高次项，得到关于$\delta y$和$\delta y'$一次项的和，称为$J[y(X)]=\int_{a}^{b} f(x,y,y')\mathrm{d}x$的一阶变分，简称为泛函的变分，即$\delta J=\int_{a}^{b}(\frac{\partial f}{\partial y}\delta y + \frac{\partial f}{\partial y'}\delta y')\mathrm{d}x$。
%\subsection{泛函变分的基本运算法则}
%泛函变分运算法则与微分运算法则基本相同

%$(\delta F_1 +F_2)=\delta F_1 +\delta F_2$

%$(\delta F)^n=nF^n-1\delta F$

%$(\delta F_1 \cdot F_2)=F_2\delta F_1+F_1\delta F_2$

%$(\delta (\frac{F_1}{F_2})=\frac{1}{F^2_2}(F_2\delta F_1-F_1\delta F_2)$

%$\delta\int_{a}^{b}F\mathrm{d}x=\int_{a}^{b}\delta F\mathrm{d}x$







%如果将泛函取极值时的函数定义为$y(x)$，并且定义与函数$y(x)$相靠近的函数为$y(x,\varepsilon)$,记为$y(x,\varepsilon)=y(x)+\varepsilon\eta(x)$,$\varepsilon$是一个参数。
%函数$y(x)$的变分定义为$\delta y=\eta(x)\mathrm{d}\varepsilon$,由此可得$\delta y'=\eta ^\prime(x)\mathrm{d}\varepsilon$
%定义泛函$J[y(X)]=\int_{a}^{b} F(x,y,y')\mathrm{d}x$的变分为$\delta J=\int_{a}^{b}(\frac{\partial F}{\partial y}\delta y + \frac{\partial F}{\partial y'}\delta y')\mathrm{d}x$。

%\subsection{泛函变分举例}
%计算泛函$J[y(x)]=\int_{-1}^{1} (y'e^7 +xy^2)\mathrm{d}x$的变分


%$\delta J[y(x)]=\delta\int_{-1}^{1}(y'e^7+xy^2)\mathrm{d}x=\int_{-1}^{1}(2xy\delta y+e^7\delta y')\mathrm{d}x=\int_{-1}^{1}(2xy\delta y)\mathrm{d}x+\int_{-1}^{1}e^7\mathrm{d}\delta y=\int_{-1}^{1}(2xy\delta y)\mathrm{d}x
%$，最后一步利用上边界上函数变分为0。






%\begin{equation}
%-\nabla \cdot (\beta\nabla u) = f(x,y),\,\ (x,y)\in \Omega
%\end{equation}
%Dilichlet 边界条件

%\begin{equation}
%u(x,y) = g(x,y),\,\ (x,y)\in \partial \Omega
%\end{equation}
%\subsection{符号}
%\begin{tabular}{ |l|l| }   
%\hline   
%\multicolumn{2}{|c|}{符号说明} \\   
%\hline
%符号 & 含义\\
%\hline
%$\Omega$ & 二维长方形区域 \\
%\hline
%$nx$ & $x$ 方向剖分的段数 \\
%\hline
%$ny$ & $y$ 方向剖分的段数 \\
%\hline
%$hx$ &  $x$ 方向每段的长度\\
%\hline
%$hy$ &  $y$ 方向每段的长度 \\
%\hline
%$\mu$ & $the \,\ viscosity \,\ coefficient$ \\
%\hline
%$k$ & $the \,\ permeability \,\ tensor$ \\
%\hline 
%$NC$ & 代表 $cell$ 的个数 \\
%\hline
%$NE$ & 代表总的 $edge$ 的个数 \\
%\hline
%\end{tabular}

%\section{欧拉—拉格朗日方程}
%欧拉—拉格朗日方程是泛函极值问题的必要条件，假设$J[y(x)]$的极值问题的解为$y=y(x)$，现在推导这个解所满足的微分方程。

%$\delta J=\int_{a}^{b}(\frac{\partial f}{\partial y}\delta y + \frac{\partial f}{\partial y'}\delta y')\mathrm{d}x=0$，将第二项分部积分得到$\int_{a}^{b}(\frac{\partial f}{\partial y'}\delta y')\mathrm{d}x=\int_{a}^{b}\frac{\partial f}{\partial y'}\mathrm{d}\delta y$，因为$\delta y(a)=0$，$\delta y(b)=0$，所以$\int_{a}^{b}(\frac{\partial f}{\partial y'}\delta y')\mathrm{d}x=-\int_{a}^{b}\delta y\mathrm{d}\frac{\partial f}{\partial y'}$，因此$\delta J=\int_{a}^{b}\frac{\partial f}{\partial y}\delta y\mathrm{d}x-\int_{a}^{b}\delta y\mathrm{d}\frac{\partial f}{\partial y'}=\int_{a}^{b}(\frac{\partial f}{\partial y}-\frac{\mathrm{d}\frac{\partial f}{\partial y'}}{\mathrm{d}x})\delta y\mathrm{d}x=0$，因为对于任何函数$\delta y$都成立，故$\frac{\partial f}{\partial y}-\frac{\mathrm{d}\frac{\partial f}{\partial y'}}{\mathrm{d}x}=0$，这就是欧拉—拉格朗日方程。
%\begin{equation*}
%\begin{cases}
%\begin{aligned}
%\frac{\mu}{k}\mathbf{u} + \nabla p & = 0 \quad in \,\ \Omega = (0,1)\times (0,1) \\
%\nabla \cdot \mathbf{u} & = f \quad in \,\ \Omega \\
%\mathbf {u} & = 0 \quad on \,\ \partial \Omega
%\end{aligned}
%\end{cases}
%\end{equation*}

%且有 \\
%\begin{equation*}
%\int_{\Omega}f dxdy = 0
%\end{equation*}

%记 $u$ 为 $\mathbf{u}$ 在 $x$ 方向的分量，$v$ 为 $\mathbf{u}$ 在 $y$ 方向的分量,则有 \\

%\begin{equation*}
%\begin{cases}
%\begin{aligned}
%\frac{\mu}{k}\cdot u + \partial_x p & = 0 \quad (1) \\
%\frac{\mu}{k}\cdot v + \partial_y p & = 0 \quad (2) \\
%\partial_x u + \partial_y v & = f \quad (3)
%\end{aligned}
%\end{cases}
%\end{equation*}

%\section{离散后组装矩阵}
%利用一阶向前差分把方程变成差分方程，现在从 $edge$ 和 $cell$ 的角度考虑模型。 \\

%对于 $(1)$, 从内部纵向 $edge$ 的角度考虑:
%我们需要找到内部纵向 $edge$ 所对应的左手边的 $cell$ 和右手边的 $cell$. 左右两边的$cell$ 所对应的 $p$ 分别记为 $p_{l}$、$p_{r}$.$u$ 为 $edge$ 的中点，记为 $u_m$。按照 $mesh$ 里的编号规则排序。\\

%则每条内部边上所对应的差分方程为:

%\begin{equation*}
%\frac{\mu}{k} \cdot u_m + \frac{p_r - p_l}{hx} = 0
%\end{equation*}

%对于 $(2)$,从内部横向 $edge$ 的角度考虑:
%我们需要找到内部横向 $edge$ 所对应的左手边的 $cell$ 和右手边的 $cell$. $cell$ 所对应的 $p$ 与 $(1)$ 中的相同。$v$ 为 $edge$ 的中点，记为 $v_m$。\\

%则每条内部边上所对应的差分方程为:\\

%\begin{equation*}
%\frac{\mu}{k} \cdot v_m + \frac{p_l - p_r}{hy} = 0
%\end{equation*}

%对于 $(3)$, 从 $cell$ 的角度考虑:
%由于单元是四边形单元，我们记单元所对应边的局部编号为[0,1,2,3](StructureQuadMesh.py 里的网格)，第 $i$ 个单元所对应的边记为 $e_{i,0},e_{i,1},e_{i,2},e_{i,3}$。\\

%则 $(3)$ 式第 $i$ 个单元所对应的差分方程为:\\

%\begin{equation*}
%\frac{u_{e_{i,1}} - u_{e_{i,3}}}{hx} + \frac{v_{e_{i,2}} - v_{e_{i,0}}}{hy} = f_i
%\end{equation*}

%我们需要生成一个 $(NE+NC)\times(NE+NC)$的系数矩阵，把它看成分块矩阵
%\begin{equation*}
%\begin{pmatrix}
% A_{1,1} & A_{1,2} \\
%A_{2,1} & A_{2,2}
%\end{pmatrix}
%\end{equation*}

%其中 \\

%\begin{equation*}
%\begin{aligned}
%A_{1,1} : NE\times NE \\
%A_{1,2} : NE\times NC \\
%A_{2,1} : NC\times NE \\
%A_{2,2} : NC\times NC
%\end{aligned}
%\end{equation*}

%$A_{1,1}$ 对应的是 $(1),(2)$ 两式的第一项，即含有 $u,v$ 的项，$A_12$ 对应的是 $(1),(2)$ 两式的第二项。

%\newpage
%\nocite{*}
%\bibliography{ref}
\end{document}

