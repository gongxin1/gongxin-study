\documentclass[12pt，a4paper]{article}
\input{../en_preamble.tex}
\input{../xecjk_preamble.tex}
\numberwithin{equation}{section}
\renewcommand {\thetable} {\thesection{}.\arabic{table}}
\renewcommand {\thefigure} {\thesection{}.\arabic{figure}}
\title{}
\author{}
\date{\chntoday}
\begin{document}
\maketitle


\section{广泛适用于嵌段聚合物的自洽场理论}

对于嵌段聚合物材料实验的设计和解释，自洽场理论(SCFT)是一个有用的工具。在这个角度，我们通过两种方法降低了实验组使用SCFT的门槛。首先，我们提出了一个改进版的开源聚合物自洽场(PSCF)软件包和基础理论教学介绍。其次，我们对于SCFT中计算需要的初始猜测的方法进行了讨论。为了展示我们的方法，我们提出了两个案例研究，其中一个是用电脑来模拟(1)体心立方结构、面心立方结构、A15、两嵌段聚合物溶体的Frank−Kasper$~\sigma$球型相(2)ABAC四嵌段三元共聚物的核－壳形态。\\
\textbf{介绍}\\
SCFT是研究块状聚合物相行为的最强大的工具之一。然而理论只有在无限链极限下有效，它只能定性描述了有序−无序转换，这些缺点超过SCFT的优点，通过Flory-Huggins理论可以从一个相对简单的局部段的相互作用去发现新的有序相。此外，聚合物的Flory-Huggins理论使得将SCFT预测与实验结果很简单的联系起来。几十年的经验表明，SCFT相当擅长预测竞争有序的相的相对稳定性和有序−有序转变的位置，它是块状高分子材料设计的关键。虽然SCFT对嵌段共聚物熔体预测有序－无序的转变的并不准确，但这些预测为理解和预测体系结构中的相似链系之间的趋势提供了一个有用的起点。

SCFT在描述多体问题进行了简化，将聚合物溶体的动力学问题转化为一个简单的问题，即在另一个链产生的电势场中分析单链的构象。关键是，SCFT计算通常比粒子基（particle-based）的模拟方法方便得多，而且通常只需要少量的桌面资源就可以产生有意义的结果。在需要识别有序−有序转换的应用中，SCFT比粒子基的方法具有特殊的优势。

很多人认为平时问题在于理论本省复杂性，其实是在理论的实际实施方面有两个关键问题。

第一个问题是，还没有健全的软件，最好是实现时的必要的数值方法。块状聚合物的SCFT解需要重复求解势场中的扩散方程，外加一个外包装器来更新势场，从而使解最终收敛到自由能泛函的最小值。最有效的求解扩散方程的方法还需要使用快速傅立叶变换和一个半步数值算法（half-stepping）来优化速度，而包装器则需要实现某种类型的优化算法。所有这些数值方法对于一个单独的实验小组从头开始实施都是很费时的。然而，所需的数值方法并不比流体力学中的Navier−Stokes方程的有限元解所需的方法困难。在其他研究领域广泛使用计算的关键是有可用的成熟软件，例如用于计算流体力学的软件(http://www.ansys.com/)以及通用的偏微分方程求解平台(https://www.comsol.com/)。

第二个问题是作为对SCFT计算输入的初始数据的生成，特别是对于复杂阶段。它是由一组高度非线性的方程组控制的，通常有多个可能的解。这些自洽场(SCF)方程的不同解对应于一个相当复杂的自由能面的不同极值点或鞍点，其中不同的局部极小值对应于竞争的候选结构。SCF方程一般采用迭代法求解，可以从不同的初始猜测收敛到不同的解，或者根本不收敛。为了利用SCFT来研究特定的结构或相位，或者比较竞争结构的自由能，人们必须知道如何产生将收敛到特定的结构的初始猜测。

目前，人们使用两种不同的策略来研究嵌段聚合物溶体及其相关体系中的相行为，有时被称为“大单元”和“单位单元”计算。在大单元计算中，SCFT模拟是在周期模拟单位单元中进行的，该单元(理想情况下)比任何期望结构的晶体单位单元大得多。如果竞争相位简单，迭代算法是好的，Drolet和Fredrickson说明了从随机初始结构开始，有时就足以识别所有相关的周期结构。由于大单元计算可以生成用户没有表示的结构，因此它们作为筛选候选结构（candidate structures）的方法可能很有用。它们的主要缺点是：(1)模拟一个大单元的计算成本较高；(2)从随机初始条件发起的大单元模拟往往会返回一个缺陷很大、有时不具有潜在对称性的收敛的SCTF结构。

我们比较关注简单的“单位单元”计算上，其中SCFT方程是在一个周期域上求解的，它只包含一个特定结构的单位单元。大多数已发表的关于相图的SCFT预测都是通过比较SCFT对竞争候选的自由能的预测来进行单位单元计算的。这种策略的主要缺点是用户需要根据与相关系统和物理直觉相结合的经验构建一组可能的候选结构，以及预测一个没有预测的结构。(请注意，如果一个简单地用于补充一个实验测量，例如，从一个密度剖面，那么对称性通常是已知的，其他竞争相的存在是无关的。)
然而，报告复杂阶段的文件通常没有在复制结果所需的详细程度上对方法作出解释。具体而言，以往的工作通常没有提供关于为复杂阶段生成初始阶段所使用的程序的详细程度。

目前的目的是试图通过删除上述讨论的这两种方法来降低实验组使用SCTF，至少在涉及已知候选相的单位单元计算的情况下是这样。

为了去除该软件，本文介绍了由Morse和同事开发的开源聚合物自洽域(PSCF)代码(http://research.cems.umn.edu/morse/code/pscf/home.php.)。我们提供了标准磁盘映像(文件)(http://pscf.cems.umn.edu)，为当前版本的OSX提供对二进制文件的访问。我们还提供了各种非传统的材料供公众下载。具体来说，除了源代码提供的输入文件和解决方案的集合之外，我们还为本文中的所有示例提供了支持信息，并详细描述了它们在Web站点（http://pscf.cems.umn.edu.）上的生成和实现。最后，我们对代码做了一些改进，其中最重要的是Anderson混合迭代算法的实现。新算法允许计算需要大型单元格的复杂相位，如Frank−Kasper$~\sigam$相，只使用没有图形处理单元(GPU)的桌面计算机。

为了消除初始化路障，我们提供了两种方法：为SCFT的输入生成所需的的初始猜测。第一种适合于含有离散物体(例如球体或圆柱体)的结构的方法是基于傅里叶空间形状因子的计算，就像分析这些相位的散射时所做的那样。第二种更适合于网络相，是基于一种水平集方法.每个示例的详细信息都嵌入到Matlab脚本中，这些脚本可以用于生成输入文件。我们用来生成初始字段的Matlab脚本可以使用Matlab或它的开放源代码相关器来执行，但是我们的可视化脚本使用的是一些仅在Matlab中可用的函数。

为了证明我们生成粒子相的初始猜测的方法，我们讨论了两个例子。在第一个例子中，我们展示了如何对四种不同的二嵌段共聚物熔体产生初始猜测和收敛的SCFT解：体心立方相(BBC)、面心立方相(FCC)、A15相、Frank-Kasper$~\sigam$相。在每一种情况下，我们从单位单元的结构、粒子的形状因子振幅以及相关的空间组开始，并给出了相关的空间组，并说明了如何将它们转化为由PSCF实现的对称约束SCFT码的输入。。在第二个例子中，我们重点讨论了(苯乙烯-b-苯乙烯-b-环氧乙烷)四嵌段三元共聚物，并说明了如何识别无序和BCC球之间的相界，以及BCC球与六角形圆柱体之间的相界。\\
\textbf{2.开源聚合物自洽场理论的实现}\\
\textbf{2.1.自洽场方程.}该程序用于求解由聚合物液体形成的准周期结构方程。一般情况下，该体系可以包含任意数量的线性块状，和小分子溶剂的混合物。为了简化讨论，我们给出了单组分嵌段共聚物熔体的相应方程，并在(支持信息部分S10)讨论了含溶剂混合物的相应方程。

我们考虑一种具有N和B嵌段的线性近端共聚物的熔体，它具有不同类型的C。用等高线变量s，0<s<N标记特定单体，用α=1，…，C标记不同类型的单体。其中，链的构型通常用随机游动统计量来模拟，而单体−单体的相互作用则被与自洽化学势场的单体相互作用所取代。在下面，ωα(R)是一个有效的化学势场，作用于任何α型单体的位置r，它是由链之间的相互作用而产生的。基于对化学势场中随机游动聚合物的统计性质的计算，将不同类型的化学势场吸引到不同的空间区域。这样的随机游动所需的统计性质可以用下列一对修正扩散方程的解来描述
\begin{equation}\label{1}
\begin{aligned}
\frac{\partial q(\mathbf{r}，s)}{\partial s} & = \left[ \frac{b_{\alpha (s)}}{6}\nabla ^2 - \omega_{\alpha (s)}(\mathbf{r}) \right]q(\mathbf{r}，s)\\
-\frac{\partial q^{+}(\mathbf{r}，s)}{\partial s} & = \left[ \frac{b_{\alpha (s)}}{6}\nabla ^2 - \omega_{\alpha (s)}(\mathbf{r}) \right]q^{+}(\mathbf{r}，s)\\
\end{aligned}
\end{equation}
两个“约化”函数$q(\mathbf{r}，s)$和$q^{+}(\mathbf{r}，s)$具有初始条件
\begin{equation}\label{2}
q(\mathbf{r}，s)=q^{+}(\mathbf{r}，s)=1
\end{equation}
其中，$b_{\alpha (s)}$是$\alpha (s)$型单体的统计段长，$\omega_{\alpha (s)}$是相应的单体化学势场，$\alpha (s)$是含单体$s$的单体类型指数。函数$q(\mathbf{r}，s)$是从单体$0$开始，单体$s$结束的链段的统计权重(即规范的，约束的分配函数)，当单体s被约束具有特定位置$\mathbf{r}$时。数量$q^{+}(\mathbf{r}，s)$是一个互补约束的划分函数，它给出了剩余链段的统计权重，从单体$N$开始，在单体$s$处整理，单体$s$又被约束到位置$\mathbf{r}$。

乘积$q(\mathbf{r}，s)，q^{+}(\mathbf{r}，s)$与整个链的约束分拆函数成正比，其中单体$s$被约束到$\mathbf{r}$位置，而链的其余部分则成正比。这个量也与在$\mathbf{r}$位找到特定单体的概率成正比。因此，可以用该方法的解来计算不同类型对象的空间分布。在这里，我们考虑每一个单体都占据体积$v$的熔体，因此每个链的体积是$Nv$。请注意，假设所有的单体都占有相同的体积，这并不是统计段长度的选择，对于不同的单体类型，这可能是不同的。以$v=1$(即反单体体积单位)为单位，给出了$\phi_{\alpha}(\mathbf{r})$型$\alpha$在$\mathbf{r}$位置的浓度。
\begin{equation}\label{3}
phi_{\alpha}(\mathbf{r})=\frac{1}{NQ}\int _{\alpha}~q(\mathbf{r}，s)q^{+}(\mathbf{r}，s) \mathrm{d}s
\end{equation}
其中关于$s$的积分被取在包含$\alpha$类型的块或块上。这里，
\begin{equation}\label{4}
Q=\frac{1}{V}\int ~q(\mathbf{r}，N) \mathrm{d}\mathbf{r}
\end{equation}
是一个链的分拆函数，其中关于$\mathbf{r}$的积分取在一个周期结构的单位单元上，$V$是单位单元体积。在这些单元中表示的约束是这样一种要求：
\begin{equation}\label{5}
\sum _{\alpha}\phi_{\alpha}(\mathbf{r})=1
\end{equation}
当满足此约束时，$\phi_{\alpha}(\mathbf{r})$可以解释为$\alpha$类型在$\mathbf{r}$位置的局部体积分数。

化学势场$\omega_{\alpha (s)}(\mathbf{r})$是用标准的形式给出的。
\begin{equation}\label{6}
\omega_{\alpha (s)}(\mathbf{r})=\sum _{\beta \neq \alpha} \chi_{\beta \alpha}\phi_{\alpha \beta}(\mathbf{r})+\xi(\mathbf{r})
\end{equation}
其中，$\chi_{\beta \alpha}$是$\alpha$和$\beta$相互作用的二值−相互作用参数，$\chi_{\alpha \alpha}=0$和$\xi(\mathbf{r})$是满足约束条件所必须选择的倍增器压力场。

方程(\ref{1})−(\ref{6})代表了SCFT一组完整的方程，需要数值求解才能得到化学势场$\omega_{\alpha (s)}$和相应的体积分数$\phi_{\alpha}(\mathbf{r})$的解。注意方程的耦合性质：公式(\ref{6})中的势场$\omega_{\alpha (s)}$取决于单体浓度$\phi(\mathbf{r})$，这进一步依赖于公式(\ref{3})中的传播子$q(\mathbf{r}，s)$和$q^{+}(\mathbf{r}，s)$的乘积。然而，公式(\ref{1})依赖于$\omega_{\alpha (s)}$。因此，在已知体积分数之前，势场是无法计算的，而在不知道势场的情况下，不能知道体积分数。结果表明，方程(\ref{1})−(\ref{6})在$\omega_{\alpha (s)}$中形成了一组非线性方程组，只能用迭代方法求解。

图\ref{图1}给出了用于求解SCFT方程的迭代数值算法。蓝色框表示SCFT主算法。主要算法以化学势场$\omega_{\alpha (s)}$的初值为输入。初始场的选择对算法收敛性的判定有着至关重要的作用，并在下一节中对其进行了详细的讨论。利用这些初始势场，求解出MDEs(方程\ref{1})，得到$q(\mathbf{r}，s)$和$q^{+}(\mathbf{r}，s)$。然后通过公式(\ref{3}和\ref{4}沿链轮廓积分单体体积分数来计算单体体积分数。计算了体积分数后，计算了自洽场方程(\ref{6})和条件(\ref{5})中的误差。如果这些误差大于某些指定的容差$\epsilon$，则使用迭代格式更新化学势场，如牛顿法、Anderson混合法、或半隐式方法。然后使用更新的势场作为输入，整个过程被重复，直到\ref{5}和\ref{6}中的误差降到指定的容限以下。
\begin{figure}[H]
\centering
\includegraphics[scale=0.5]{./figures/1.png}
\caption{用于固定单元格数值表示的步骤。蓝色框表示在$\omega$字段内实现的过程，而红色框表示生成合理初始值所需的过程。本文提出的方法是在实际应用中解决这一问题。势场的更新，$\delta _{\omega_{\alpha}(\mathbf{r})}$，是用Broyden‘s方法或安德森混合格式计算的。一个有变单元格的SCFT计算算法是相似的，但单位单元参数(即某些格型的尺寸和角度)随$\omega$字段的每次迭代后都可以更新。}
\label{图1}
\end{figure}
一旦得到了(\ref{1})−(\ref{6})的解，得到的结构的每个单体的自由能计算如下：
\begin{equation}\label{7}
\begin{aligned}
\frac{F}{k_BT}\frac{v}{V} & =  -\frac{1}{N}\ln (eQ)+\frac{1}{2V}\sum _{\alpha \beta} \xi_{\alpha \beta}\int \phi_{\alpha}(\mathbf{r})\phi_{\beta}(\mathbf{r}) \mathrm{d}\mathbf{r}\\
& - \frac{1}{V}\sum _{\alpha} \int \omega_{\alpha}(\mathbf{r})\phi_{\beta}(\mathbf{r})\mathrm{d}\mathbf{r}\\
\end{aligned}
\end{equation}
不同的自洽解对应于不同的自洽解；每个可能的准周期解代表有序结构，而齐次解对应于非相。周期转换的自由能一般取决于晶胞的尺寸和(对于某些单位单元系统)晶胞轴间的角度。平衡自由能由单元电池给出，该单元电池使在7中给出的自由能最小化。平衡计算因此，给定相位的自由能要求优化单元-单元参数以及SCF方程的解。对于简单的中性阶段、立方体阶段，这相当于对单个单元尺寸的值进行优化。对于Fddd相，这可能需要对多个单元参数进行多维优化.优化单元的复杂算法可以利用SCFT自由能的导数有关单位单元参数的知识，它可以作为修正的扩散方程解的一部分，并以最小的附加费用计算。可以选择在更新潜在字段的同时更新单元参数。为了利用单元计算来构造相图，通过比较一组竞争对象的自由能，利用每个候选相的最优单位单元参数，确定了参数空间中各点的稳定相位。这一程序中固有的不确定性是需要构造一个可能的候选结构的列表，并确定地知道所提议的列表是否包括全局最小值。

图\ref{图1}所示的辅助功能足够通用，几乎可以描述任何新的实现。不同的研究人员和研究小组所提出的实现方法之间最大的区别是，对于固定化学势场的数值算法的选择(这是该算法的循环)和更新化学势场的迭代算法的选择和(在某些情况下)单元-单元参数的选择是不同的。单元-单元计算开发的代码它们是否施加特定的空间群对称也是不同的在该溶液中。本节的剩余部分简要描述了由PSCF提供的算法和特征。

\textbf{2.2.MDE Solver.}在PSCF码中，采用了一种变异的方法来求解这一应用程序，并给出了相应的解决方案。同样的算法可用于描述完全三次周期结构，如网络或球体形成阶段，二维周期结构，如近正相，或一维非周期结构。在伪谱方法中，MDES的12个周期解在单个1、2或3维单位单元格内离散化在空间上在规则的尺寸网格上。对于具有小时间步长的方程，通过“时间步进”对时间样轮廓变量s也是近似的。一个典型的当代计算可能使用32到128个网格点沿每个空间方向和100个等高线长度步长每链。

伪频谱算法的特点是使用快速傅立叶变换(FFT)来精确地和有效地表示$q$和$q^{+}$的拉普拉斯算子(参见等式1)在一个周期域。所需的原始伪频谱算法一个前向FFT和一个逆FFT的计算等高线长度时间步长为$\Delta$，并给出了全局精度$(\Delta s)^2$。在Ranjan et al的附录中描述的该算法的变体得到了更高的阶数精度$(\Delta s)^4$，且每步计算量较高。重复计算所需的再粒度算法，给出了总成本的计算结果。我们PSCF的实现版本依赖于FFTW软件包来计算所需的转换。相应的OSX应用程序也可供公众下载，所有必要库已经嵌入到应用程序中，只需双击图标即可运行。

在实际空间中，无论是实际空间中的化学势和单体浓度场的表示，还是作为一个实际空间网格节点上的一个值数组，还是在傅里叶空间中，作为离散傅里叶变换的系数，其源代码都提供了对化学势场和单体浓度场表示的方便。在实空间网格表示中，三维势场$\omega (\mathbf{r})$在网格点$\mathbf{r}(m_1，m_2，m_3)$给出，其中$m_i \in \left[ 0，N_i-1 \right]$。
\begin{equation}\label{8}
\mathbf{r}(m_1，m_2，m_3)=\sum _{i=1}^{3}\mathbf{a}_i \frac{m_i}{N_i}
\end{equation}
其中，$N_i$是向$i$方向的数字网格点。这里，$\mathbf{a}_1，\mathbf{a}_2$和$\mathbf{a}_3$是标准常规单元的准格矢量，例如立方单元，用于具有立方对称性的相位。傅里叶空间表示是平面波基函数的一种展开式，它由相互格向量给出，
\begin{equation}\label{9}
\mathbf{q}(n_1，n_2，n_3)=\sum _{i=1}^{3}n_i\mathbf{b}_i
\end{equation}
整数$n_i\in [0，N_i−1]$的范围内，$\mathbf{b}_1，\mathbf{b}_2$和$\mathbf{b}_3$是满足$\mathbf{a}_i \cdot \mathbf{b}_j=2\pi \delta _{ij}$的相互格基向量。

\textbf{2.3.Symmetry.}附属器使用的空间等距施加周期性边界条件，但不施加任何其他空间群，如反射面、离散旋转，或涉及单位单元的一小部分平移的准平面或螺旋轴。然而，无论是用于输入和输出化学势和浓度场的外部迭代算法还是用于输入和输出化学势和浓度场的文件格式，都使用更为紧凑的表示特定空间群对称性的场作为对称适配傅里叶展开。用户可能需要对这种类型的扩展有一定的了解，因为它是用于输入和输出单体化学势和浓度场的文件格式的基础，因此我们在这里提供了一个比较详细的技术描述。

在对称适配傅里叶展开中，已知空间群对称性的实周期场$\omega (\mathbf{r})$被展开为和。
\begin{equation}\label{10}
\omega (\mathbf{r})=\sum _{n=1}^{P} a_nf_n(\mathbf(r))
\end{equation}
$P$对称适应基函数$f_1(\mathbf{r})，...，f_P(\mathbf{r})$具有实系数$a_i，...a_P$。每个对称适配基函数都是特征值问题$-\Delta ^2f_i(\mathbf{r})$的实周期解，它在特定空间群的所有对称元下都是不变的。

作为一个简单的例子，考虑一维周期为$L$的周期场$\omega (x)$具有反演对称性$\omega(x)=\omega(-x)$。对于$n=2，3，...，P$，可以用对称适配基$f_1(x)=1$和$f_n(x)=\sqrt{2cos\left[ 2\pi (n-1)x/L \right]}$展开。一般实一维周期函数不具有反演对称性的展开式，将使用既含正弦基函数又包含相应基函数的展开式。

一般情况下，任意$1，2$或$3$维空间群的每个对称适应基函数$f_n(\mathbf{r})$都可以表示为和
\begin{equation}\label{11}
f_n(\mathbf{r})=\frac{1}{\sqrt{S}}\sum_{j=1}^{S}c_je^{i\mathbf{q}_j\cdot \mathbf{r}}
\end{equation}
具有一组S平面波的倒数格波向量$\mathbf{q}_1，...，\mathbf{q}_s$，它们通过空间群相互关联。每一种对称相关的波向量有时被称为“恒星”。例如，立方晶体中互易格矢量的每一颗星对应于同族{}的向量q(h，k，l)，它们之间的指标集相互关联，符号的变化和$h，k，l$的符号的变化有关，$\mathbf{q}(h，k，l)$带有整数$(h，k，l)$属于同族${hkl}$。对称适配基函数的展开式只包含与恒星相关联的基函数，这是由所选空间群的系统规则所允许的。例如，对于类似晶体的展开不包含与${hkl}$的值相关联的基函数，对该基函数$h+k+l$的和是奇数。

方程\ref{11}中的系数$c_1，...，c_{n_s}$通常是单位绝对值的复数，$\left\|c_j\right\|=1$。对于的逆对称空间群$\omega{\mathbf{r}}=\omega{\mathbf{-r}}$，这些系数都可以看作实数，$c_j=\pm 1$。然而，在某些近似群中，星体内不同平面波的系数可以有$\pm 1$的相反符号值。例如，这发生在阶段(gyroid phase)的̅$I\alpha \bar{3} d$组中。

使用PSCF的迭代算法和使用输入和输出的文件格式都使用对称适配傅里叶展开来表示所有化学势场和单体浓度场。$\omega$势场的初始读取和输出$\omega$和$\phi$字段的解决方案所使用的文件格式包含每个字段的这些系数的列表，扩展了方程\ref{10}中给出的形式。迭代算法通过修改此展开中的系数来更新$\omega$势场后
MDEs的每一个解。在从文件中读取$\omega$势场的初始猜测之后，每次更新这些字段之后，该表示都会在解MDE解之前自动转换为通用的使用MDEs解Fourier展开。在求解和计算单体浓度场后，将生成的浓度场转换回对称自适应表示，供外部迭代算法使用并输出到文件中。在外迭代循环中使用对称自适应展开，自动限制了对具有特定空间群对称性的SCF方程解的搜索。

用户在输入脚本中输入所需空间组的名称，该脚本还包含FFT网格的每个方向上的网格点数。在读取这部分输入脚本之后，在读取$\omega$势场的初始猜测之前，PSCF自动生成一组适合于指定空间组和FFT网格的对称适配基函数。对于为特定空间组和网格生成的基础的描述，可以通过调用输出输入脚本中的Output-Wave命令将其输出到文本文件中。PSCF可以读取和正确解释为具有相同空间组但具有不同空间的结构而生成的$\omega$势场，以便将粗网格的模拟用作网格计算的输入。PSCF还提供了输入脚本命令，允许用户在包含ω或φ字段对称适应表示的文件和在实空间fft网格节点上包含这些字段值的文件之间进行转换，方法是读取这两种格式中的一种格式的文件和另一种格式中的文件。有关这些特性和其他特性的更详细说明，请参见Web用户手册24。
虽然PSCF辅助单元计算主要用于单元计算，并具有强加的空间组对称性，但用户只需指定由空间组标签“i”标识的标识空间组，就可以禁用此限制。这个平凡的空间群除了空间外没有对称性，并相应地导致产生一个完整的正弦波和准波的基础。

\textbf{2.4.迭代算法}PSCF允许用户选择两个不同的迭代算法来更新$\omega$势场和(随意的)优化单元尺寸。第一种算法是拟牛顿法(NR)，其首次发布以来一直是PSCF的一部分。本文实现的第二种算法是一种无随机安德森混合Jacobian-free
Anderson-mixing算法.

PSCF中的拟牛顿法结合了物理激励的初始逼近法和改进的近似法和线搜索法相结合的方法。该算法既可用于求解固定单元中SCF方程或者同时求解SCF方程，并在每次迭代时使用$\omega$势场和单元格维的完全耦合同时更新，找到最佳的单元尺寸。该算法的初始逼近是用数值差分法构造的，用来计算表示误差导数(残差向量的分量)的矩阵中相对于ω场的小分量系数的部分，而对于较高分量的导数则使用简单的等高线2逼近法。这一算法要求用户输入一个新的，命名为Ncut，指定应该计算数值导数的对称适配傅里叶分量的数目。

这个拟牛顿/Broyden算法的性能和成本的几个方面需要被潜在的用户理解。对于$Jacobian$初始近似的构造是一个潜在的缓慢过程，其计算费用与选择近似线性增加。因此，该算法的用户应该对该参数的选择进行实验，以确定需要多大的值才能获得收敛性。我们通常选择Ncut=100−200。该算法在构造初始节点后，往往需要几十步，最后几步几乎是二次收敛。该算法的一个优点是优化单元的边际成本较低；寻找最优单元所需的步骤数一般可与在固定单元中求解方程所需的步骤数相媲美。该算法的一个重要限制是存储近似矩阵所需的大量内存，它与计算中使用的对称自适应基函数的平方成正比。对于需要$10^4$个以上基函数的计算，无论是因为结构是强的，还是因为它有一个复杂的单元(如Frank−Kasper σ阶段)，所需内存可能超过当前典型硬件上可用的内存。

我们最近增加了安德森混合算法到PSCF中，主要是因为需要一个比准牛顿格式更小的内存需求的迭代算法。Anderson混合格式所需的内存仅随对称适配基函数的数目线性增加，通常比存储非均匀解所需的内存少得多。安德森混合算法和它的有效性的证据已经在以前的工作中被提出了由更多的同事和同事。这里需要实现安德森混合算法来模拟单CPU核上的弗兰克−σ相位。在我们的经验中，用于求解固定单元中的方程的Anderson混合算法通常比准牛顿算法需要更多的步骤，且每步平均计算成本较低。我们目前这种算法的一个缺点是，用一个最优单元计算一个解所需的时间远远大于在固定单元中求解该方程所需的时间。

PSCF中的准牛顿和安德森混合算法都不是绝对稳定的，也不能保证算法收敛到ω场的任意初始猜测。这两种算法从良好的初始猜测中相对较快地恢复，但相对于一些可以对解决方案(尽管不一定是所期望的)具有更强鲁棒性的替代方案而言，即使是随机初始ω字段也是如此。未来关于迭代算法的研究将集中在提供更稳健的迭代算法作为替代，以及改进在拟牛顿格式以外的算法中用于优化单元格的方法。

介绍了PSCF中提供的许多特征，以简化相图的计算。在这类计算中，可以通过求解两个或多个候选相在参数空间中沿一条直线排列的参数点的序列上的近似问题和确定竞争相的自由能变化符号在哪里的差异来识别相边界。PSCF提供了一个用户命令(扫描命令)，该命令允许用户使用解决方案的二阶连续完成这样的计算序列，从而使除第一个或两个参数点之外的所有参数点都快速收敛。当在这样的计算序列中使用时，PSCF的拟牛顿算法是特别有效的，因为这种特征的实现尽可能地使以前的计算中得到的近似更接近。这种延续特性还使用户可以相对容易地从以前获得的特定结构的解决方案(有时可以从随代码分发的示例中获得)开始，在不同的参数集中获得相同结构的解决方案。

\textbf{2.5.输入参数.}PSCF中的该操作由一个包含物理参数和控制所需操作序列的命令的输入脚本控制。文件格式的细节见在线用户手册，示例包括在支持信息部分。

输入脚本中指定物理参数的部分被设计为允许描述包含一个或多个线性嵌段聚合物物种和(随机的)零或多个小分子溶剂物种的混合物。用一个块作为嵌段聚合物来处理均聚物。单组分嵌段聚合物熔体所需的参数包括(1)每种单体类型的统计段长；(2)共聚物中的嵌段数以及每一段的单体类型和长度(重数)；(3)所有所需的二元Flory-Huggins相互作用参数的值；(4)单元的描述，其中包括空间尺寸(1，２或3)，晶体系统(如立方或准晶系)、空间群名称和单元参数(即任何相关的单元尺寸和角度)。文件格式不对统计段长度和单元格尺寸施加特定的长度单位系统：只要所有长度都在同一单位系统中给定，用户就可以输入这些长度。

SCFT和PSCF都允许用户在如何定义“单体”方面具有一定的灵活性。它是基于连续高斯随机游动的聚合物的数学模型，它不包含任何离散单体或化学重复单位的概念。因此，该理论的所有预测都可以证明，在每种聚合物物种的聚合数变化的情况下，都是不变的，这是由$\lambda$的一个共同因素决定的，对应于单体体积增加一倍的$\lambda$。这种传统的改变可以实现在取$N \rightarrow N/ \lambda$的所有聚合物和嵌段长度，同时也改变单体的统计段长度和相互作用参数的因素，分别为$b_{\alpha}\rightarrow b_{\alpha}\sqrt{\lambda}$和$\chi _{\alpha \beta} \lambda$。请注意，每个块的可测量根平均端到端长度$R_{\alpha}=\sqrt{N_{\alpha}b_{\alpha}}$的转换值和形如$\chi _{\alpha \beta} N_{\alpha}$的乘积，其中$N_{\alpha}$是$\alpha$类型块的等高线长度。$N$的常规变化也会影响$\omega$场的值，它被定义为每个单体的自由能除以$k_BT$，从而转化为$\omega _{\alpha} \rightarrow \lambda \omega _{\alpha}$。对“单体”定义的唯一限制是，不同类型的单体必须占用相同的体积，因此每个块所占的体积与输入脚本中给定的长度成正比。在此变换下，嵌段共聚物熔体的每链自由能不变，仅取决于$\chi N$值、嵌段体积分数和统计段长比。PSCF提供了一个RESCALE命令，允许用户通过$\omega$场和相关的输入参数应用此转换，以便利$N$的约定的更改。

在所有与PSCF一起分布的例子中，嵌段共聚物的一个有用的惯例是使用单位，在输入脚本中输入单个块的长度作为分数值，加到1，从而整个链取$N=1$，其中一个(或全部)统计段长度被取为一个(或全部)，$b=1$。在此约定中，输入脚本中输入的每一个$\chi$值应设置$\chi N$的期望值，因为$N=1$，而每个单元维$d$的值应对应单位单元尺寸的比值$d/\sqrt{Nb}$与根平均端到端长度$\sqrt{Nb}$的比值。

为了计算特定实验系统的适当SCFT参数，通常更方便地从单体参比体积为链长的单体参比体积与化学单体的体积相当的约定开始。在该方法中，选择一个参考体积$v$与实际的每一化学重复单位体积相比较，然后以$m_{\alpha}=N_{Av}\rho v$作为$\alpha$型“单体”的摩尔质量$m_{\alpha}$，其中ρ是对应的均聚物熔体的质量密度，$N_{Av}$是Avogadro的数。用$M/m_{\alpha}$给出了每个$\alpha$类型块的对应数，其中$M$是每个块的摩尔质量。用$b_{\alpha}^2=m_{\alpha}\left\langle R_c^2 \right\rangle/M $给出了相应$\alpha$类型块的统计段长，其中，$\left\langle R_c^2 \right\rangle/M$对应的均聚物在熔体状态下，平均端到端长度与摩尔质量之比。如果需要，就可以将生成的一组参数值转换为上面描述的重新表示形式。

\textbf{3.生成初始场猜想}

在第2节中描述的数值方法是在开源聚合物自洽场代码中实现的。此代码的源文件与大量文档一起公开。我们还为Linux提供了二进制版本，并为OSX提供了标准版本。然而，正如我们在一开始就指出的那样，仅仅使用适当的软件是不够的。此外，对于每个感兴趣的结构，需要可靠的方法为$\omega$场生成足够的初始值。在实践中，如果初始$\omega$场与期望的解不够接近，则迭代算法可能不会或可能接近不同的解。

尽可能从相同空间组和结构的系统的先前计算的解开始，获得对$\omega$场使用的初始猜测的最简单方法。可通过PSCF主页上的链接下载一组用于大多数已知的共聚物结构的示例解决方案和几个示例性共聚物结构的示例。通常可以在参数空间(扫描命令)提供的参数空间中使用特征来将这些示例中的一个转换为与创建示例所使用的参数不同的一组参数(例如，一组交互参数、链长度和组合的值)的解决方案。还可以利用这一特性将共聚物的溶液转化为具有不同数目的嵌段的溶液(将其转化为或相反)，方法是连续插入初始长度的新块或删除现有的块，或将块-mer熔体的溶液转化为共聚物混合物的溶液。或小分子溶剂，通过不断增加溶剂的体积分数从零。我们建议，当尝试使用PSCT来模拟特定的结构时，用户首先要考虑是否可以从现有的示例开始。

在本节的其余部分中，我们讨论了直接从感兴趣结构的几何模型生成体积分数的初始猜想和化学势场的方法，在没有适当的例子的情况下。3.1和3.2描述了为不同类型的结构生成成分剖面近似模型的两种策略。第一种方法，我们称之为“形状因子”方法，适用于与同一组分形成球形或圆柱形粒子相关联的相位。第二种方法，我们称之为“水平集”方法，特别适用于网络阶段，如分级阶段。在3.3小节中，我们讨论了一个简单的近似，用于从合成剖面模型生成$\omega$场的初始猜测。第3.4小节讨论了用户如何使用本文提供的脚本来实现表单因子方法的一些细节。支持信息部分中提供了水平集方法的相应信息。

\textbf{3.1.形成因子法(粒子相)。}在这里，我们把自己限制在由离散的“粒子”组成的微结构，例如球形粒子，其中除一个成分以外，所有的成分都是在这些粒子中仅存在，而一个或多个组分(矩阵)则是这些粒子的主要成分。将该矩阵设置为混合好，初始猜测，然后由SCFT解算器细化。

$\alpha$型的单体的体积函数$\phi _{\alpha}(\mathbf{r})$在任意周期微结构中可以表示为傅里叶级数
\begin{equation}\label{12}
\phi _{\alpha}(\mathbf{r})=\sum _{\mathbf{q}}\phi _{\alpha}(\mathbf{q})\exp (-i \mathbf{q} \cdot \mathbf{r})
\end{equation}
其中$\mathbf{q}$是由公式\ref{9}给出的倒格波矢量，其和在所有倒易向量，$\phi _{\alpha}(\mathbf{q})$是傅里叶系数。对于同类，让单体类型$A$是包含在离散的球形或圆柱形粒子中的物种。这个分量的每一个傅里叶系数$\phi _{A}(\mathbf{q})$都可以作为和
\begin{equation}\label{13}
\phi _{A}(\mathbf{q})=\frac{1}{V}\sum _{j=1}^{N_{particles}} f_{j}(\mathbf{q})\exp (i \mathbf{q} \cdot \mathbf{r}_j)
\end{equation}
其中$f_{j}(\mathbf{q})$是每个单位单元中第$j$个粒子的形状因子振幅，$\mathbf{r}_j$是第$j$个粒子在单位单元中的位置，$N_{particles}$是每个单元中粒子的数目，$V$是每个单位单元的体积。

关于粒子形状、大小和位置的信息可以从实验中获得，从而建立一个心理观察阶段的模型。或者，我们可以将任意形状和大小的粒子放置在任何想要的位置来模拟类似的结构。对于通常观察到的形状，如球体、圆柱体、等分等，形状因子是已知的。一旦粒子的所有信息被固定，单体体积分数就可以用公式\ref{13}来计算。请注意，对于不满足相关空间组允许散射反射的条件的新值，可自动生成零值。

最简单的形式因素是固体粒子模型，它对应于粒子内部的体积分数，否则为零。例如，尺寸为$R$的球体具有$\phi _{\alpha}(\mathbf{r})=1，|\mathbf{r}|<R$，和$\phi _{\alpha}(\mathbf{r})=0，|\mathbf{r}|>R$。这类固体粒子模型假设存在尖锐的界面，对应于无限强偏析的非物理极限。SCFT求解器通常可以平滑最初强烈分离的剖面，但如果从具有有限浓度梯度的涂抹界面开始，则收敛速度可能更快、更健壮。我们可以涂抹界面，用高斯来卷积锐利的界面模型，将每一个傅里叶系数乘以一个高斯涂抹因子。
\begin{equation}\label{14}
f_{smear}(\mathbf{q})=\exp \left[ -\sigma _{smear}^2 \frac{(|\mathbf{q}|R)^2}{2} \right]
\end{equation}
其中，$-\sigma _{smear}$表示由半径为$R$的球形或圆柱形粒子的的界面宽度。根据涂片期望值，可以选择$0<-\sigma _{smear}<1$的值。利用Helfand−Tagami理论可以很好地估计界面的实际宽度。根据这一理论，界面的宽度与相互作用参数$\chi$成反比，称为$\sigma _{smear} R=2b/(6 \chi)^{1/2}$，其中$b$是统计段的长度。对于构象不对称的聚合物，我们可以取$b$作为两个相关统计片段长度的几何平均值。
在涂抹界面的情况下，给出了单体体积分数的每一个傅里叶系数
\begin{equation}\label{15}
\phi _A(\mathbf{q})=\frac{1}{V}\sum _{j=1}^{N_{particles}} f_J(\mathbf{q})\exp (i \mathbf{q \cdot \mathbf{j}}) f_{semar}(\mathbf{q})
\end{equation}
然后，如第4节所述，通过施加不可压缩性，得到矩阵类型的相应傅里叶系数。

\textbf{3.2水平集方法(网络阶段)}

第二种方法非常适合于网络阶段，其实质是用指定空间群的第一非零对称适配基函数的水平面表示初始结构。水平面表示三维空间变化函数具有常值的平面，称为水平集。一旦得到水平表面，则水平表面内的体积被形成网络结构的单体所占据，而水平表面外的体积则形成矩阵。在计算这个水平面的过程中的第一步是找到水平集值，使得水平面内的体积对应于构成网络的单体类型的体积分数。

我们描述了一种简单的算法来实现这种方法，像我们的形式因子法一样，两种混合物可以扩展到一个混合矩阵中。在支持信息部分S6中给出了实现该算法的一个实例。设物种$A$为少数组分(即网络)，$B$为矩阵，体积分数$f_A$和$f_B=1−f_A$。我们在PSCF输入文件中输入单个单体类型的单位系数，并使用PSCF在网格上生成一个表示结果场的PSCF，从而生成实空间网格上第一个非同质对称适应基函数$f_1(\mathbf{r})$的表示。例如，陀螺相位将使用与波矢的${2，1，1}$星相关联的基函数，该基函数对应于波数q最小的散射实验中允许的一组反射。然后在网格点上生成$f_1(\mathbf{r})$值的直方图。然后将该直方图转换为累积直方图，从中我们确定水平集值$c$，从而使网格点的$f_A$部分的$f_1(\mathbf{r})<c$。其中$f_1(\mathbf{r})<c$的所有网格点都位于网络组件所占用的区域内，为此我们设置了$\phi _A=1$和$\phi _B=0$。其余的网格点是矩阵，对应于$\phi _A=0$和$\phi _B=1$。这会产生一个锐利的界面，当在网格上表示时，它会变得有点像素化。如果有必要，您可以在将概要文件作为输入传递给PSCF之前先涂抹它。然而，在实际应用中，我们发现在PSCF中使用的迭代算法即使作为输入，也会收敛到期望的解。

\textbf{3.3.从成分到化学势场}

一旦我们获得了一个特定阶段的组合轮廓的近似模型，我们就必须将它转换为$\omega$场的初始猜测，因为PSCF需要一个$\omega$场作为初始输入。或者ω字段，因为pscf需要一个ω字段作为初始输入。我们发现，要获得收敛到所需结构的初始场，通常只需先将拉格朗日乘子压力场设置为零，设置$\xi(\mathbf{r})=0$，才能得到初始猜测
\begin{equation}\label{16}
\omega _{\alpha}(\mathbf{r})=\sum _{\beta \neq \alpha} \chi _{\alpha \beta} \phi _{\beta}(\mathbf{r})
\end{equation}
对于$\omega$的这一初始猜测通常与用来创建它的体积分数剖面不一致，因此也不是对SCFT方程的解：当MDES作为SCFT算法第一次迭代的一部分求解时，通过积分得到的传播子的体积分数将不等于公式\ref{16}中用于构造初始$\omega$的体积分数。此外，通过使用这些初始$\omega$场求解MDEs得到的体积分数的通常不满足以下要求：不可压缩性约束。但是，如果该方法成功，这些误差将被迭代算法纠正，而不会反映在最终收敛的SCFT解中。

这种简单的$\omega$初始化方法的成功突出了数值问题的一个重要方面：$\omega$场的初始猜测不必非常接近所需的解，只要初始猜测足够好地代表了迭代器吸引所需解的整体结构。在我们的经验中，通过将拉格朗日场设置为零得到的初步猜测通常是足够的。
\begin{figure}[H]
\centering
\includegraphics[scale=0.5]{./figures/2.png}
\caption{陀螺仪相位($I\alpha \bar{3}d$)的三维正射图与(a)水平集法得到的初步猜测和(B)收敛的SCFT解。因为没有涂抹，所以最初的猜测包含了一个有点像素化的界面，它的小特性反映了底层FFT网格的分辨率。计算条件为$\chi N=20，f_A =0.35$，和$b_A/b_B=1$，且网格尺寸为$32\times 32\times 32$。计算得到的结构相对于无序相的每链自由能为$\Delta F /k_b T =-0.63169$。(a)中有争议的结构的尺度维数为4，而由SCFT得到的松弛单元维数为3.85。A块的体积分数是为体积分数$\phi _A(\mathbf{r})\geqslant 0.5$绘制的.
}
\label{图2}
\end{figure}
为了提供一个具体的例子，图\ref{图2}显示了计算二嵌段共聚物熔体中陀螺仪相的初始和最终组成剖面。在这种情况下，我们使用了水平集方法，没有模糊的接口，以产生一些什么粗略的初始近似。复制此示例所需的文件在“支持信息”中的文件目录中提供。

\textbf{3.4.工作流.}在这一小节中，我们更详细地描述了应用形状因子法生成复杂粒子相的初始猜测的过程。在支持信息部分S6中给出了水平集方法的相应描述。该工作流使用Matlab脚本生成组合轮廓模型，并使用PSCF进行不同字段表示之间的转换和求解SCFT方程。

图\ref{图3}描述了应用形式因子方法模拟粒子相位的步骤，例如BCC或Frank−kasper$\sigma$阶段。首先，我们使用Matlab或Octave运行一个名为Density\_Phase的Matlab脚本来计算感兴趣结构的体积分数的Fourier系数。这将输出一个名为Rho\_kGrid的文件，其中包含使用公式\ref{15}的傅里叶系数。该文件的内容是按照3.1节中的算法创建的。接下来，在名为param\_kGrid的参数文件的控制下运行PSCF代码，该文件指示PSCF读取Rho\_kGrid，应用逆傅里叶变换(使用KGRID\_to\_RGRID命令)，并输出一个名为Rho\_rGrid的文件，该文件包含坐标空间网格中所有组件的体积分数的值。然后，可以使用另一个名为共聚物\_visual的Matlab脚本可视化Rho\_rGrid文件，以确认最终猜测的质量正确性，并在必要时调整涂片因子。最后，在一个名为param的参数文件的控制下再次运行PSCF，该文件指示pscf读取文件rho\_rGrid，通过将Lagrange乘子场初始设置为零，从这个体积分数字段模型中生成相应的ω-字段，然后使用图\ref{图1}所示的迭代过程，使用该初始猜测求解SCFT方程。如果需要的话，在第一次和第二次调用PSCF期间执行的计算可以合并成一个单独的运行；我们分离它们只是为了让用户有机会在赞成放弃之前可视化Rho\_rGrid文件，并适当地调整公式\ref{15}中的涂抹因子。当得到一个收敛的溶液时，PSCF将输出两个文件，名为omega和rho，分别包含最终的化学势和体积分数场，第三，一个名为OUT的文件包含(除其他信息外)每个单体的自由能和有序相的单位单元尺寸的最终值。
\begin{figure}[H]
\centering
\includegraphics[scale=0.5]{./figures/3.png}
\caption{流程图描述了使用表单因子方法和PSCF代码的初始化方法执行所需的SCFT计算所涉及的步骤。有关水平级方法的类似大纲，请参见支持信息节S6。为了开始这个过程，需要将文件(作为支持信息中的存档)density\_-phase、Param、param\_kGrid和copolymer\_visual复制到同一个工作目录中。支持信息部分S1给出了每个文件的描述，支持信息部分S5提供了每个文件的示例，绿色框是聚合SCFT计算的结果，而红色框包含输入文件，黄色框包含用于运行程序的命令行执行语句，蓝色框表示执行计算所需的中间文件或步骤。}
\label{图3}
\end{figure}

\textbf{4.实例研究}

我们通过实验观察到的两个例子证明了形式因子法的适用性：二嵌段共聚物中的离散颗粒相和聚(苯乙烯-b-异戊二烯-b-环氧乙烷)四嵌段共聚物中的核−壳球和圆柱体。

\textbf{4.1.二嵌段共聚物中的颗粒形成相。}
双嵌段共聚物在过去已经得到了广泛的研究，目前仍是研究嵌段共聚物相行为的最简单的模型。除了经典例子形成相，如BBC球，最近，在一种聚异戊二烯-丙交酯(IL)二嵌段共聚物中观察到了配合物Frank−Kasper$\sigma$相.$\sigma$相在质量再分布的BBC相中成核，在一个单位细胞内形成五个不同的粒子群。此外，还证明了保持恒定密度的约束$\sigma$相中的“粒子”达到非理想球形的形状。虽然BCC相中的粒子有时被称为球形，但我们将所有这些相称为粒子形成相。

$\sigma$相位使用自洽场的研究是一个具有计算挑战性的问题。$\sigma$相位有一个巨大的单元，有30个粒子，因此需要大量的网格点来适当地解决这个结构。另一个主要问题是产生一个合理的初始猜测，它能很好地表示结构，足以收敛到SCFT方程的适当解。然而，谢等人.报道了σ相在SCFT构象不对称二嵌段共聚物中的确定，并预测了它在miktoARM嵌段共聚物中的存在。。此外，作者还认为，二嵌段共聚物中两嵌段的统计段长不对称有利于$\sigma$相的形成而不是BCC相的形成。


在本节中，我们演示了我们生成初始势场的方法是通用的，并且可以很容易地应用于复杂的$\sigma$相位。实际上，$\sigma$相所涉及的复杂性是检验该方法的鲁棒性的理想测试。随后，我们使用同样的方法为另外三个粒子形成阶段(FCC，BCC和A15)生成SCFT解，并在相图中的一个状态点检验所有四个竞争相的相对稳定性。这里，我们只介绍了$\sigma$相阶段的一步的过程，而其他阶段的步骤则在支持信息部分S3中提供。

根据谢氏等人所报道的相图的基础，我们认为AB二嵌段共聚物的熔体体积分数$f_A=0.25$，统计段长的比率是$b_A/b_B=2$，使A嵌段形成粒子，而B填写矩阵。我们首先计算了在公式\ref{15}中给出的域形成粒子的涂抹体积分数剖面。为了评价这个表达式，我们需要以下信息：单位单元维数来计算倒数空间矢量$\mathbf{q}$、位置($\mathbf{j}$)和每个粒子的大小(R)，并形成粒子的因子振幅$f_j(\mathbf{q})$。在实验中发现的$\sigma$相由一个四方单元细胞组成，a=431，c=228，并被指定为P42/mnm空间群(第136号)。对于四边形单元格，倒数空间中的基向量是
\begin{equation}\label{17}
\mathbf{b}_1=\frac{2\pi}{\alpha}\hat{e}_1，~~~\mathbf{b}_2=\frac{2\pi}{\alpha}\hat{e}_2，~~~\mathbf{b}_3=\frac{2\pi}{\alpha}\hat{e}_3
\end{equation}
其中，$\hat{e}_1$、$\hat{e}_2$和$\hat{e}_3$分别是笛卡尔坐标系x、y和z方向上的单位向量。

粒子的位置在实验上是用Wyckoff位置来报告的。利用国际晶体表中P42/MNM空间群的对称运算，将个Wyckoff位置变换为各自的协坐标。例如，4f(0.104，0.104，0)的威望模拟位置导致(0.104 a，0.104 a，0)，(0.896a，0.896a，0)，(0.396 a，0.604a，0.5c)，以及(0.604a，0.396a，0.396a)，0.5C)作为单位单元中四个粒子的坐标。“支持信息”第S2节提供了将所有其他Wyckoff位置转换为各自坐标的过程，总共产生了30个粒子。

必须指出的是，粒子在单元格中的确切位置决定了结构的对称性，是一项重要的要求，而粒子的大小和形状可以近似。因此，对于初始化过程，我们假设所有的粒子都是大小相等的球体，并表明这种假设不会妨碍收敛，因为粒子的大小和形状在SCFT迭代过程中会发生调整，但确实会影响收敛速度。用公式\ref{15}计算$\phi _A$所需的球体的形状因子振幅是
\begin{equation}\label{18}
f(\mathbf{q})=\left( \frac{4\pi R^3}{3}F(|\mathbf{q}|R) \right)
\end{equation}
这里
\begin{equation}\label{19}
F(x)=\frac{3\left[ \sin(x) -x\cos(x) \right]}{x^3}
\end{equation}
$\mathbf{q}=(0，0，0)$的值被赋值为$\lim x\rightarrow 0 F(X)=1$，给出$f(\mathbf{q}=0)=4\pi R^3/3$。请注意，将此值替换成公式\ref{15}，用30个球体代替体积V的单位单元产生$f(\mathbf{q}=0)=30×(4\pi R^3/3)/V=f_A$，从而得到正确的平均体积分数。这个关系给出了使用等半径的模型的球体半径。B块的体积分数是
\begin{equation}\label{20}
\phi _B(\mathbf{q}) =
\begin{cases}
1-f_A， & \mbox{if }\mathbf{q}=(0，0，0)\\
-\phi _A(\mathbf{q})， & \mbox{if }n\mathbf{q}\neq (0，0，0)
\end{cases}
\end{equation}
上述体积分数分布与不可压缩性一致.使用第2.2节描述的索引惯例，必须在$0<m_i<N_i，i=1、2、3$的范围内，计算所有$\mathbf{q}(m_1，m_2，m_3)$的这些Fourier分量。请注意，由于离散周期网格上的值“混叠”，因此在此区域上计算Fourier分量就足够了，因为该区域上只包含$m_1$、$m_2$和$m_3$的非负值，这导致了整数$m_i$与任意方向i的整数乘$N_i$相差无几的波矢的等价性。

我们使用Matlab脚本(在支持信息部分S3.1.1中提供)计算了所有$\mathbf{q}$的少数分量所需的傅里叶振幅，并计算了图\ref{图3}所示字段的相应值。在多次重复涂片系数、$\sigma _{smear}$的情况下，我们选择$\sigma _{smear}=0.35$，即在每个球体中心的体积分数$\phi _A=0.95\pm0.02$。

图\ref{图4}显示了通过上述计算得到的单元内体积分数剖面的2D和3D视图，这构成了基于实验数据的合理的初始猜测。正如预期的那样，所有的粒子都是大小相等的球体。此外，界面被涂抹和轮廓是光滑的。然后将相应的势场作为初始猜测提供给SCFT迭代器，在$\chi N=25$的中间偏析强度下寻找鞍点。图\ref{图5}绘制了在收敛的SCFT迭代结束时获得的$\sigma$相的体积分数。计算采用应力松弛的Anderson混合格式。在大约800次迭代中实现了收敛，在一个单独的Intel 2.6GHz处理器上需要12小时。需要指出的是，大部分的计算时间都用于解除单元的应力，这导致了单元尺寸的大约25\%的变化，同时保持了实验报告的比例，$a/c=1.89$。

图\ref{图4}和图\ref{图5}的主要区别是单位细胞中粒子的形状和大小发生了显著变化。如图\ref{图5}所示，在$\sigma$相中有粒子的形状和大小的分布。所得结构的每链自由能相对于无序相的自由能约为$10^{-1}K_BT$与文献报道的计算结果一致。
\begin{figure}[H]
\centering
\includegraphics[scale=0.5]{./figures/4.png}
\caption{(a)2D顶部视图和(b)使用上述初始化方法获得的$\sigma$相近似的3D透视视图。为了简化可视化，只绘制体积分数$\phi _A(\mathbf{r})\geq 0.5$的A块的体积分数。涂片系数$\sigma_{smear}=0.2$，被用来得到涂片轮廓。计算的网格尺寸为$128\times 128\times 64$，单元尺寸$a=7.55，c=3.99$。单位单元的尺寸按未受干扰的根均方端到端长度，$R_{end}=(N_L b_L^2 + N_I b_I 2)^{1/2}$根据实验报告的数值计算，$N_L=13，N_I=47，b_L=9.9A，b_I=6.5A$用于IL二嵌段共聚物。}
\label{图4}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[scale=0.5]{./figures/5.png}
\caption{(a)二维顶视图和(b)由收敛的SCFT迭代得到的$\sigma$相的三维透视视图。只绘制体积分数$\phi _A(\mathbf{r})\geq 0.5$的A块的体积分数。计算是在$\chi N=25$和$f_A=0.25$的情况下进行的。得到的结构相对于无序相的每链自由能为$\Delta F/k_BT=−0.46950$。应力松弛单元的尺寸$a=9.55，c=5.02$。}
\label{图5}
\end{figure}

我们使用同样的方法(支持信息部分S3)生成三个粒子形成阶段的初始势场，这三个阶段应该与$\sigma$相竞争：$BCC，FCC$和$A15$。对于所有情况，涂片轮廓提供给SCFT迭代器。图\ref{图6}描述了在各自收敛的SCFT迭代结束时获得的所有四个阶段的单元格。请注意，BCC和FCC相仍然有接近球形的粒子，而A15相有扭曲的球体。除A15相和$\sigma$相外，任意两种结构的每链自由能差为$10^{-3}k_BT$，其中差为$10^{_4}k_BT$阶。这突出说明了在比较复杂相时使用SCFT所面临的挑战，因为其结果对统计片段长度和相互作用参数$\chi$的选择极为敏感。我们还注意到，其他三个阶段取得的结果与先前报告的结果是一致的。

我们成功地为复杂的A15和$\sigma$相播种和放松SCFT解决方案，证明了该方法是稳健的。在支持信息部分S3中，我们提供脚本来生成粒子形成阶段的初始势场，这些初始势场可以适当地改变所需的中间阶段，并与pscf代码一起使用来执行SCFT计算。

\begin{figure}[H]
\centering
\includegraphics[scale=0.5]{./figures/6.png}
\caption{(a)BCC，(b)FCC，(c)A15和(d)在各自收敛的SCFT迭代结束时获得的$\sigma$相的3D透视视图。只绘制体积分数$\phi _A(\mathbf{r})\geq 0.5$的A块的体积分数。计算是在$\chi N=25$和$f_A=0.25$的情况下进行的。得到的结构相对于无序相的每链自由能分别为$\Delta F/k_BT=−0.46808，−0.46556，−0.46906，−0.46950$。BCC和FCC的网格尺寸分别为$36\times 36\times 36$，A15和$\sigma$的网格尺寸分别为$64\times 64\times 64$和$128\times 128 \times 64$。}
\label{图6}
\end{figure}

所有SCFT计算中的一个问题是选择一个适当的网格大小来平衡精度和计算效率。积分步长$\Delta s$和收敛容差$\epsilon$的选择也会对收敛结果产生影响，但影响程度较小。支持信息部分S9包含关于这些参数对本案例研究的影响的其他信息。

\textbf{4.2.单组分四嵌段三元共聚物中的核−壳相.}当与二嵌段相比，添加更多的区块和单体类型提供了更多的有序形态。例如，在ABAC型四嵌段共聚物中，观察到了倒置相，$O^{70}$网络相，核−壳球和圆柱体，$\sigma$相，和一个十二度准晶态。本节的案例研究是基于这样一种多嵌段聚合物，即聚(苯乙烯-b-异戊二烯-b-苯乙烯-b-环氧乙烷)(SISO)四嵌段三元共聚物。特别地，我们用我们的方法研究了在−四边形块体中实验观察到的BCC填充核−壳球和六边形填充核−壳柱。此外，我们还对无序−球转变和球−圆柱相变的相界进行了计算，仅考虑了BCC核−壳球、六角核−壳柱和无序相作为竞争相。

这个例子是由于我们希望证明我们的方法适用于多嵌段聚合物，以及不同的粒子形状，如圆柱体。支持信息部分S3.2.1提供了核心−外壳球的初始化。在这里，我们只提供了六边形填充的核心−壳圆柱的细节。再次，我们开始计算涂抹体积分数剖面给出的方程\ref{15}。SISO四块中的核心−壳柱布置在二维六角形晶格中，单位单元尺寸为$a\approx 200$，并被指定为P6mm点群对称。我们考虑了一个面积$A=a^2\sqrt{3/2}$的本原单位单元，它的二维六角形晶格只包含一个核心半径R的PEO圆柱体，其中心位于2D坐标系的原点，给出了一个PEO体积分数$f_o=2\pi R^2/(\sqrt 3a^2)$。对于二维六边形晶格，倒数空间中的基向量是
\begin{equation}\label{21}
\mathbf{b}_1=\frac{2\pi}{\alpha}\hat {\exp}_1-\frac{2\pi}{\sqrt{3}\alpha}\hat{\exp}_2，~~~\mathbf{b}_2\frac{4\pi}{\sqrt{3}\alpha}\hat{\exp}_1
\end{equation}
半径为R的圆柱体沿z轴排列在这样一个二维晶体中的二维形状因子振幅是
\begin{equation}\label{22}
f(\mathbf{q})=\pi ^2 RF(|\mathbf{q}|R)
\end{equation}
其中$\mathbf{q}$是xy-平面上的向量。在后者中，$F(x)\equiv 2J_1(x)/x$和$J_1(x)$是一阶贝塞尔函数。在$\mathbf{q}=0$时$f(\mathbf{q})$的值用极限$\lim _{x\rightarrow 0} F(x)=1$赋值，给出$f(\mathbf{q}=0)=\pi R^2$。通过在方程\ref{15}中使用方程\ref{22}，我们得到了
\begin{equation}\label{23}
\phi _o(\mathbf{q})=f_o F(|\mathbf{q}|R) \exp \left[ -\sigma _{smear}^2 \frac{(|\mathbf{q}|R)^2}{2} \right]
\end{equation}
对于形成圆柱形芯的PEO单体的体积分数进行傅里叶变换。

为了对其他两种单体的体积分数分布进行初步的猜测，我们把它们混合到圆柱形芯之外的任何地方。这给了
\begin{equation}\label{24}
\begin{aligned}
\phi _s(\mathbf{q}) & =f_s，
\phi _I(\mathbf{q})  =f_I，~~~~if~\mathbf{q}=(0，0)\\
\phi _s(\mathbf{q}) & =-\frac{f_S}{f_S+f_I}\phi _o(\mathbf{q})，
\phi _I(\mathbf{q})  =-\frac{f_I}{f_S+f_I}\phi _o(\mathbf{q})，~~~if~\mathbf{q} \neq (0，0)\\
\end{aligned}
\end{equation}
其中$f_I$和$f_S$分别是PI和PS单体类型的体积分数。在核−壳外，I和O的均匀混合假设是不正确的，但它提供了一个初步的猜测，足以使其收敛到期望的解，从而显示出核的壳层的形态。

一旦计算出所有单体类型的傅里叶变换体积分数剖面，我们将它们转换成图\ref{图3}所示的各自的势场。类似于以前的情况，我们反复使用这种变换，并在网格上监视体积分数剖面，以选择一个合理的涂抹系数值，$\sigma _{smear}=0.4$。然后将平滑的体积分数剖面的势场作为猜测提供给SCFT迭代器来搜索鞍点。

单组分四嵌段共聚物的SCFT参数空间包含5个参数：$\chi _{IS}N，\chi _{IO}N，\chi _{SO}N，f_O$和$f_I$。用实验报道的不同单体类型的体积分数和分子量确定了聚合度N。注意，我们考虑的是SISO四块，其中两个S块的长度相等。我们使用以下二进制交互参数：
\begin{equation}\label{25}
\chi _{IS}=\frac{26.4}{T}-0.0288，\chi _{IO}=\frac{108.8}{T}-0.0695，\chi _{SO}=\frac{59.6}{T}=-0.0458
\end{equation}
这些相互作用参数是通过修改Frielinghaus等人报告的参数得到的$^{57}$.为了使理论预测与Bluemle等人的实验结果相吻合。51我们强调，虽然参数是通过拟合程序获得的(支持信息部分S8)，这个案例研究的目的是检验我们的初始化方法对于不同粒子和多块多MERS的适用性。我们把对这些相互作用参数的全面分析推迟到以后的一项研究，重点放在这种特殊的多嵌段聚合物上。

一旦指定了所有参数，我们就使用上面计算的势场开始搜索鞍点。由于与$\sigma$相比，这两种结构都有较小的单元细胞，所以我们采用Broyden方法。Broyden的方法在寻找鞍点的同时减轻了单元细胞中的应力，尽管每次迭代比简单的Anderson混合使用更多的内存和计算时间。我们观察到，实验中报告的有序相$T=140$和$120°C$的温度温度符合强偏析极限。因此，我们为势场选择的初始猜测不会在1000次迭代中收敛到鞍点。在强偏析时，SCFT方程变得相当严格，要求场的猜测值非常接近鞍点。通常情况下，解决这个问题的方法是先在较低的偏析强度下获得一个解，然后逐渐将该解演化到偏聚强度的较高值的鞍点。在这个问题中，我们首先用上述方法得到了$T=180°C$的两个相位的解，然后利用PSCF码的扫描特性分别得到了$T=140°C$和$T=120°C$的鞍点。

图\ref{图7}(a)和\ref{图7}显示了从收敛的−迭代得到的各个单元中的核心壳圆柱和球体的体积分数剖面。图\ref{图7}(c)绘制了六方相单元[110]方向上SISO中每个块的体积分数剖面图，而图\ref{图7}(d)则绘制了BCC单元中沿[111]方向的体积分数剖面图。从图中可以清楚地看出，PEO块形成了由PS屏蔽的离散微域，PI和终端PS填充了矩阵。
\begin{figure}[H]
\centering
\includegraphics[scale=0.5]{./figures/7.png}
\caption{(a)具有$P4_2/mm$的核−壳柱和(b)在各自收敛的−迭代结束时得到的具有$Im\bar{3}m$空间群的核−壳球。PEO单体类型为绿色，PS为蓝色，PI为红色。(c)(a)所示单元中[110]方向上的体积分数剖面，以及(d)(b)中所示单元[111]方向上的体积分数剖面。在$T=140°C$和$f_O=0.15$时，对Bluemle等人报道的$f_I:f_S=50:50$等值线进行了计算。51采用$36\times 36\times 36$网格点离散BCC结构，$48\times 48$网格点离散六角相位。}
\label{图7}
\end{figure}
在实验中，通过从母体SIS三嵌段中扩增出预期长度的PEO嵌段，合成了SISO四嵌段共聚物。通过探索参数空间对等值线的影响，探讨了加入PEO对等值线的影响：$f_I：f_S=50：50$，$f_I：F_S=60：40$。为了与实验进行比较，我们以类似的方式进行了scft计算，分别确定了形成球体和圆柱体所需的PEO量。图\ref{图8}报告了在实验报道的温度下无序的−BCC转变和BCC−十六进制转变的SCFT结果，以及两个等温层的一些较高的温度。对于$f_I：f_S=50：50$等值线，SCFT预测的相范围与实验观测值一致。然而，对于$f_I：F_S=60：40$，实验报道的范围明显高于理论预测的范围，这可能是由于$\chi$模型中未包含的参数的成分依赖性所致。然而，SISO四嵌段核−壳层形态的形成证明了我们的多嵌段聚合物结构计算方案的鲁棒性。

\textbf{5.结论}我们提出了两种方法，以产生物理启发和实际有用的初步猜测，以进行单位单元SCFT计算所需的潜在场。为粒子相提出的方法利用以下关于有序微相的信息对所需的化学势场进行了估计：(1)单元胞的尺寸和类型；(2)形成微畴的粒子的形状、大小和位置；(3)微相的空间群对称性。这些信息通常来自散射和电子显微镜实验，这些实验通常用来表征有序的微相。因此，这种方法对于理解实验发现的微相的稳定性和指导实验工作在有前途的方向上具有实用价值。


目前，人们使用Matlab脚本来构造每个感兴趣的结构的组成轮廓的数学模型。开发一个基于计算机辅助设计(CAD)的输入也可能是有用的，它可以将用户提供的候选相位的CAD绘图转换为涂抹的化学势场，作为SCFT煅烧的输入。虽然我们已经提高了基于CPU的pscf代码处理涉及大单元的问题的能力，但我们也认识到修改代码以使用GPU和/或多个CPU核来加速性能是有用的。

我们通过两个例子论证了我们的方法对粒子相的适用性：二嵌段共聚物中的成球相和单链嵌段聚合物中的核−壳球和圆柱体。在第一个例子中，我们使用我们的方法生成两个相对简单的相(bcc和fcc)以及复杂的A15和σ相的势场的猜测值。四个阶段的场的猜测值收敛到各自适当的鞍点，表明该方法是稳健的，只需要台式计算机就可以用于研究嵌段聚合物中的复杂相。此外，我们计算了所有四个相的自由能，并比较了它们在相图中某一特定状态点的相对稳定性。在第二个例子中，我们使用该方法生成了在单链−四嵌段三元共聚物中BCC填充核−壳球和六边形填充核−壳柱的场的初始值。两个阶段的初始场值收敛到所需的结构，再次证明了我们的方法的稳健性。此外，我们还对不同温度值下的无序−BCC和BCC−十六进制跃迁进行了SCFT计算，并与实验结果进行了比较。我们还展示了一个使用水平集方法初始化字段的网络阶段收敛的例子。这里描述的方法是通用的，提供了利用SCFT理解和探索嵌段聚合物中新相的诱人机会。


\cite{tam19912d}

%\bibliography{../ref}
\end{document}
