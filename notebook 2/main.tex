% !Mode:: "TeX:UTF-8"
\documentclass[12pt,a4paper]{article}
\input{../en_preamble.tex}
\input{../xecjk_preamble.tex}
\numberwithin{equation}{section}
\renewcommand {\thetable} {\thesection{}.\arabic{table}}
\renewcommand {\thefigure} {\thesection{}.\arabic{figure}}
\title{The Shapes of Things}
\author{龚欣}
\date{\chntoday}

\begin{document}
\maketitle

\section{第一章~~~~~~介绍}
\subsection{曲面上微分方程}
这本书是对微分几何的介绍，这对含有几何偏微分方程（PDE）的数学模型很有用，例如标准拉普拉斯方程的曲面或流形（manifold）。尤其是，这需要发展曲面梯度和曲面拉普拉斯算子。这些在标准欧几里得空间里（如$\mathbb{R}^n$）是普通的梯度$\nabla$和拉普拉斯算子$\Delta =\nabla \cdot \nabla$，但是在曲面或流体上定义就会变得特殊。\\

这种方法的优点是，它提供了几何量的替代公式，例如这些在微分几何中的公式，和（平均）曲率（curvature）比文章平时的表达式更清楚。

\subsection{关于形状的微分}
这本书中的微分几何方法有利于形状微分学的框架发展（framework of shape differential calculus），这是研究一个独立的“形状变量”的如何随其变化而变化的。

\subsubsection{一个简单例子}
接下来的例子需要freshman calculus的工具。令$f=f(r,\theta)$是定义在极坐标下半径为$R$的圆盘$\Omega$上，$F$是圆盘上的积分，如
\begin{gather}
F=\int_{\Omega} f=\int_{0}^{2\pi}\int_{0}^{R} f(r,\theta)r\mathrm{d}r\mathrm{d}\theta.
\end{gather}

显然，$F$依赖$R$，我们假设$f$总是依赖$R$，如$f=f(r,\theta;R)$。在物理例子中，$F$是液体通过横截面积为$\Omega$的管道的净流量(net flow rate)。在这种情况下，$f$是单位面积下的流速，可以是定义在$\Omega$上的偏微分方程的解。例如，在圆管中的Navier-Stokes流体。

知道$F$关于$\Omega$的灵敏度是有好处的，例如为了优化目的。换句话说，如果$R$增加，$F$会如何变化呢？现在我们看$F$关于$R$进行求导：
$$\frac{d}{dR}F=\int_{0}^{2\pi}\left( \frac{d}{dR}\int_{0}^{R}f(r,\theta;R)r\mathrm{d}r \right)\mathrm{d}\theta =\int_{0}^{2\pi}\int_{0}^{R}f^{'}(r,\theta;R)r\mathrm{d}r\mathrm{d}\theta + \int_{0}^{2\pi}f(R,\theta;R)R\mathrm{d}\theta$$
这里$f^{'}$是关于$R$求导。$f$对$R$的依赖性可以看做$f$对$\Omega$的依赖性。例如，$f(\cdot;R)\equiv f(\cdot;\Omega)$。使用笛卡尔坐标系(Cartesian coordinates)$\mathbf{x}$重新写上面公式有
\begin{gather}
\frac{d}{dR}F=\int_{\Omega}f^{'}(\mathbf{x};\Omega)\mathrm{d}\mathbf{x} + \int_{\partial \Omega}f(\mathbf{x};\Omega)\mathrm{d}S(\mathbf{x})
\end{gather}
这里$\mathrm{d}\mathbf{x}$是体积测度，$\mathrm{d}S(\mathbf{x})$是表面积测度。

\subsubsection{一般扰动}
令$\boldsymbol{v}$是$\partial \Omega$的单位外法向量。我们把增加的$R$看做速度场（velocity field）$\mathbf{V}$,在法方向上$\mathbf{V}$驱动$\Omega$上的点，取在$\Omega$上$\mathbf{V}=\boldsymbol{v}$。因此，方程$(2)$变成
\begin{gather}
\frac{d}{dR}F=\int_{\Omega}f^{'}(\mathbf{x};\Omega)\mathrm{d}\mathbf{x} + \int_{\partial \Omega}f(\mathbf{x};\Omega)\mathbf{V}(\mathbf{x})\cdot \boldsymbol{v}(\mathbf{x})\mathrm{d}S(\mathbf{x})
\end{gather}
我们把$\mathbf{V}$看成一个速度场，它会瞬间扰动（instantaneously perturbs domain）定义域$\Omega$。我们称$\mathbf{V}$是一个域扰动（domain perturbation）。现采用$f(\mathbf{x};\Omega)\equiv f(\Omega)$和$f^{'}(\mathbf{x};\Omega)\equiv f^{'}(\Omega;\mathbf{V})$，这里$f^{'}$是于域波动$\mathbf{V}$的$f$的形导数（shape derivative）。类似，我们定义$\delta F(\Omega;\mathbf{V})\equiv \frac{d}{dR}F$为$F$在方向$\mathbf{V}$上对于$\Omega$的形扰动（shape perturbation）。因此，我们有
\begin{gather}
\delta F(\Omega;\mathbf{V})=\int_{\Omega}f^{'}(\Omega;\mathbf{V})+\int_{\partial \Omega}f(\Omega)(\mathbf{V} \cdot \boldsymbol{v}),
\end{gather}
这是第五章中公式$(5.47)$，
$$\delta \varepsilon (\Omega;\mathbf{V})=\int_{\Omega}\dot{f}(\Omega;\mathbf{V})+\int_{\Omega}f(\Omega)(\nabla \cdot \mathbf{V})=\int_{\Omega}f^{'}(\Omega;\mathbf{V})+\int_{\partial \Omega}f(\Omega)(\mathbf{V} \cdot \boldsymbol{v})$$因此，我们导出公式$(5.47)$，其中对于$\Omega$是一个被速度场$\mathbf{V}$扰动的圆盘，使$\Omega$沿着法线方向上均匀扩大。这本书的主要目的是对于一般区域$\Omega$和一般扰动$\mathbf{V}$导出方程$(4)$，和其他类似的公式。

形微分的框架提供了建立平均曲率流（mean curvature flow）和Willmore流方程的工具，它们是流体力学和生物学等许多应用中的几何流。见第六章和第七章例子。

\subsubsection{Sequential Optimization of Shape}
怎么下山是显而易见的。只要你看见和感觉到地面，你就可以清楚地知道往哪个方向走才可以降低你的海拔。作为下一节动机，我们将其视为优化任务。换句话说，设$f=f(x,y)$是小山表面高度的函数，$(x,y)$是我们位置的对应。然后使用基本多变量微积分，找到一个下山方向相当于求$f$的梯度，并且沿着梯度相反的方向移动。所以我们不需要看整个函数，我们仅仅需要局部地计算梯度$\Delta f$，类似于感受下面的地面。

方程$(4)$的形扰动类似于梯度算子。它提供了局部的斜率，或者相当于某些参数敏感度的量。实际上，$(1.4)$是一个方向导数，类似与$\mathbf{V} \cdot \Delta f$，这里$\mathbf{V}$是一个方向。
\begin{tabular}{ |l|l|l|}   
\hline   
  &  标量函数 & 形状泛函 \\
\hline
量 & $f$ & F \\
\hline
参数 & $(x,y)$ & $\Omega$ \\
\hline
方向导数 & $\mathbf{V} \cdot \Delta f$ &  $\delta F(\Omega;\mathbf{V})$ \\
\hline
\end{tabular}
\\
上述表中类比并不相同，例如，只需要指定两个数$(x,y)$,而需要指定$\Omega$	无限个坐标对。$\mathbf{V}$是标量函数集合中的二维向量；对于形状函数，$\mathbf{V}$是一个完整的函数，需要在$\Omega$中的每一点上定义。这个“有限维数”是使用符号$\delta F(\Omega;\mathbf{V})$表示形状扰动。

因此，$\delta F(\Omega;\mathbf{V})$表示为了减少$F$我们应该如何改变$\Omega$，类似于为了减少$f$，如何改变$\Delta f(x,y)$和对应的坐标对$(x,y)$。形状优化$[3,23,48,51,54,59,75,93,106,107]$。下一节将介绍工程形状优化的一个经典示例。\\
\textbf{减少阻力}\\
虽然下面的例子超出了本书的范围，但它很好地展示了形状微分学的威力。考虑经过刚体的流(参见图$1.1$)。流向量速度场$\mathbf{u}$以无维形式遵从称为Navier-Stokes方程的偏微分方程$[8,79,101]$:
\begin{gather}
\begin{aligned}
(\mathbf{u}\cdot \Delta)\mathbf{u}-\Delta \cdot \sigma & =  0~~~in~\Omega,\\~\Delta \cdot \mathbf{u} & = 0~~~in~\Omega,\\~\mathbf{u}& =0~~~on~\Gamma _B,\\~\mathbf{u}& = e_x~~~on~\Gamma _O,
\end{aligned}
\end{gather}

\begin{gather}
\begin{aligned}
\sigma(\mathbf{u},p):& = -pI+\frac{1}{Re}D(\mathbf{u})\\D(\mathbf{u}):& = ~\Delta \mathbf{u}+(\Delta \mathbf{u})^T
\end{aligned}
\end{gather}
其中$0$为零向量，$e_x =(1,0)$为外边界$\Gamma _O$上的速度边界条件,$\sigma$为压力张量（stress tensor），$p$为压力。Reynolds数$Re$是与流的物理特性相关的无量纲参数。此时完全理解$(1.5)$和$(1.6)$并不重要。只要知道它们模拟了一个流如何在一个施加的流场中围绕一个固定的刚体运动就足够了。
\begin{figure}[H]
\centering
\includegraphics[scale=0.5]{./figures/11.png}
\caption{流体通过刚性$\Omega _B$ 的图。流体在$\Omega$中出现，由Navier-Stokes方程控制。$\Omega$的边界，记为$\partial \Omega$，划分为$\partial \Omega = \Gamma _B \cup \Gamma _O$，$\Gamma _B$ 为刚体的边界，$\Gamma _O$为远离刚体的外边界。$\Omega$的单位外法向量为$\nu$。}
\end{figure}

这里的目标是找到最佳形状的$\Omega _B$，以尽量减少对身体的阻力;这是形状优化中的一个经典问题$[42,69,82 -84]$。为此，我们需要指定一个形状函数代表阻力，即，
\begin{gather}
J_d(\Omega)=-e_x \cdot \int_{\Gamma _B}~\sigma(\mathbf{u},p)\nu,
\end{gather}
其中，我们使用$\Omega$来表示$\Omega _B$的形状，(这是因为$\Omega$和$\Omega _B$共享边界$\Gamma _B$。也可以证明$J_d$等于
\begin{gather}
J_d(\Omega)=\frac{1}{2Re}\int _{\Omega}\left| D(\mathbf{u}) \right|
\end{gather}
表示在$\Omega$域中能量的粘性耗散总量(单位时间)。注意，很明显，$J_d \geq 0$。利用形状扰动机制，$\delta J_d(\Omega;\mathbf{V})$表明$J_d$改变当我们在方向$\mathbf{V}$上扰动$\Omega$。因此,我们可以使用这些信息来微小的改变$\Omega$，慢慢变成一个形状,具有更好的(低级）阻力特性。

图$1.2$给出了一个数值计算来说明这一点。令$\Omega ^0$和$\Gamma _B$的初始猜测的形状的身体;这些在迭代$0$中显示。可以看到在身后面出现了两个大的涡流，这表明有大量的粘性耗散(大阻力)。优化过程，对于$\mathbf{V}$的许多不同的选择计算得到$\delta J_d(\Omega;\mathbf{V})$，至多选择一个驱动向下的$J_d$，最多。这个$\mathbf{V}$的选择用于在第一次迭代中将$\Gamma _B^0$变形为一个新的形状$\Gamma _B^1$，$\Gamma _B^0$在$\Gamma _B^1$和之间只有很小的差别。这个过程重复多次，结果如图$1.2$所示。注意旋涡（vorticses）是如何被更细的形状所消除的;显然，迭代$60$次时的对象比初始圆形具有更小的阻力。 
\begin{figure}[H]
\centering
\includegraphics[scale=0.5]{./figures/12.png}
\caption{通过图形优化阻力。从一个圆形的$\Gamma _B$(不是很符合空气动力学)开始，我们应用了一个最陡的下降优化方案来缓慢地进化到最小的$J_d$。蓝色曲线是速度场$\mathbf{u}$的流线，它满足$Re=200$的$(1.5)$
}
\end{figure}

因此，形状扰动使我们能够在无限维的形状中“爬下山”。这是一个自动生成复杂工程设计的强大工具。在图$1.2$中，这是在没有人决策干涉的优化模型。在创建仅有人类干涉的$1.5$的计算机模型，开发了一种生成形状序列的优化算法。
事实上，相同的优化机制可以用于不同的PDE系统，如弹性。描述形状优化的完整细节超出了本书的范围，但是在$6.3.1$节中有一个简短的讨论

\subsection{概念}
\subsubsection{向量}
所有向量变量都被认为是列向量，并以黑体符号表示。例如，$(q_1,...,q_n)$是$\mathbb{R}^n$中一个有$n$元素的行向量。如果$\mathbf{a}\in \mathbb{R}^n$是一个列向量，则我们可以写$\mathbf{a}=(a_1,a_2,a_3)^T$,此处$T$为转置算子。两个向量的点积可以写成$\mathbf{a} \cdot \mathbf{b}=\mathbf{a}^{T} \mathbf{b}$，其中两个向量为列向量。我们定义$|\mathbf{a}|$是向量$\mathbf{a}$的欧几里得范数。附录$A$中有关于向量，矩阵的基本概念和特性。
\subsubsection{梯度}
我们使用$t$是一个曲线参数，但是有时候类似于物理时间。对于曲面，用$s_1$，$s_2$表示参数变化量。符号$\Delta$是标准空间的梯度算子。所有向量导数算子（例如$\Delta$）都被认为行向量。如果$f=f(x,y,z)$是一个标量值函数，则$\Delta f$是一个$1\time 3$行向量。符号$\Delta _x$是关于变量$\mathbf{x}$的梯度，例如$\mathbf{x}=(x,y,z)$，则
$$
\\Delta _x=\left( \frac{\partial}{\partial x},\frac{\partial}{\partial y} ,\frac{\partial}{\partial z} \right).
$$
\subsubsection{积分}
我们通常使用$\Omega$作为$\mathbb{R}^3$中体积为正的定义域（或者$\mathbb{R}^2$）。我们定义$\Gamma$是$\mathbb{R}^3$的曲面，$\sum$是曲线。通常区域$D$s上特定映射表示$id_D$，例如$id_{\Omega}(\mathbf{x})=\mathbf{x}$，对$\Omega$中所有的$\mathbf{x}$,则
$\int _{\Omega} f(\mathbf{x})\mathrm{d}\mathbf{x}=\iiint_{\Omega} f(x_1,x_2,x_3)\,\mathrm{d}x_1\,\mathrm{d}x_2\,\mathrm{d}x_3.$
$\mathrm{d}\mathbf{x}$是体积积分，$\mathrm{d}S(\mathbf{x})$是面积积分，$\mathrm{d}a(\mathbf{x})$是曲线积分。此外，我们经常写积分如下
$$
\int _{\Omega} f(\mathbf{x})\mathrm{d}\mathbf{x} \equiv \int _{\Omega} f,~~~\int _{\Gamma} f(\mathbf{x})\mathrm{d}S(\mathbf{x}) \equiv \int _{\Gamma} f,~~~\int _{\sum} f(\mathbf{x})\mathrm{d}a(\mathbf{x}) \equiv \int _{\sum} f
$$
我们定义一个集合测度$|\cdot|$，例如
\begin{gather}
|\Omega|=\int _{\Omega}1,~~~|\Gamma|=\int _{\Gamma}1,~~~|\sum|=\int _{\sum}1
\end{gather}
因此，$|\Omega|$表示$\Omega$的体积，$|\Gamma|$表示$\Gamma$的表面积，$|\sum|$表示$\sum$的长度。




\input{2.1.tex}
\input{2.2.tex}
\input{2.3.tex}
\input{2.4.tex}
\cite{tam19912d}
%\bibliography{../ref}
\end{document}
